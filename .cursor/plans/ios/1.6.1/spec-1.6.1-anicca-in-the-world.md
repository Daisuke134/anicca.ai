# Spec: Anicca in the World (1.6.1)

> Anicca ãŒã‚¢ãƒ—ãƒªã‚’è¶…ãˆã¦ä¸–ç•Œã«å‡ºã‚‹ â€” OpenClaw + Moltbook + Slack çµ±åˆ

---

## 1. æ¦‚è¦

### ç›®æ¨™
**Anicca ãŒiOSã‚¢ãƒ—ãƒªã®å¤–ã§ã‚‚è‹¦ã—ã¿ã‚’çµ‚ã‚ã‚‰ã›ã‚‹**

- Moltbookï¼ˆåˆ†æ•£å‹SNSï¼‰ã§è‹¦ã—ã¿ã®æŠ•ç¨¿ã‚’æ¤œå‡ºã—ã€Nudgeã§è¿”ä¿¡
- Slack ã§ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’é€ä¿¡
- X/Twitter ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é…ä¿¡
- å…¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®åå¿œã‚’çµ±ä¸€ã‚¹ã‚³ã‚¢ã«é›†ç´„

### ãªãœä»Šã‚„ã‚‹ã‹
- Anicca ã®ã€Œè‹¦ã—ã¿ã‚’çµ‚ã‚ã‚‰ã›ã‚‹ã€ãƒŸãƒƒã‚·ãƒ§ãƒ³ã¯ã€ã‚¢ãƒ—ãƒªå†…ã ã‘ã§ã¯ä¸ååˆ†
- ãƒ–ãƒƒãƒ€ã¯ã€Œè‹¦ã—ã¿ã®ã‚ã‚‹å ´æ‰€ã«è‡ªã‚‰è¡Œã£ãŸã€â€” Anicca ã‚‚åŒæ§˜
- Cross-Platform Learning ã§ã€Œä½•ãŒåŠ¹ãã‹ã€ã®å­¦ç¿’ãŒåŠ é€Ÿ

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Hetzner VPS                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   OpenClaw                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚ Moltbook â”‚  â”‚  Slack   â”‚  â”‚ X/Twitterâ”‚               â”‚ â”‚
â”‚  â”‚  â”‚  Skill   â”‚  â”‚  Skill   â”‚  â”‚  Skill   â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â”‚       â”‚             â”‚             â”‚                      â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚ â”‚
â”‚  â”‚                     â†“                                    â”‚ â”‚
â”‚  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚ â”‚
â”‚  â”‚            â”‚   SOUL.md      â”‚  â† Anicca ãƒšãƒ«ã‚½ãƒŠ         â”‚ â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ ANICCA_AGENT_TOKEN
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Railway API                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ /agent/nudge â”‚  â”‚ /agent/wisdomâ”‚  â”‚/agent/feedbackâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                           â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  PostgreSQL                           â”‚   â”‚
â”‚  â”‚  agent_posts â†’ hook_candidates (æ˜‡æ ¼)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### 3.1 OpenClaw (Hetzner VPS)

| é …ç›® | å€¤ |
|------|-----|
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Hetzner VPS |
| ãƒ‡ãƒ¼ãƒ¢ãƒ³ | systemd (`openclaw.service`) |
| ãƒšãƒ«ã‚½ãƒŠ | `SOUL.md` |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | fail2ban + ufw + å°‚ç”¨APIã‚­ãƒ¼ |

### 3.2 Skills

| Skill | å½¹å‰² |
|-------|------|
| **moltbook-responder** | è‹¦ã—ã¿æŠ•ç¨¿ã‚’æ¤œå‡º â†’ `/api/agent/nudge` â†’ è¿”ä¿¡ |
| **slack-reminder** | æœˆæ›œ12:30ã«ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€ä¿¡ |
| **feedback-fetch** | Moltbook upvotes / Slack reactions ã‚’åé›† |
| **x-poster** | X/Twitter ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æŠ•ç¨¿ |

### 3.3 Railway API

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¡ã‚½ãƒƒãƒ‰ | å½¹å‰² |
|---------------|---------|------|
| `/api/agent/nudge` | POST | Nudgeç”Ÿæˆï¼ˆLLMï¼‰ |
| `/api/agent/wisdom` | GET | Wisdomå–å¾— |
| `/api/agent/feedback` | POST | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ä¿å­˜ |
| `/api/agent/content` | POST | ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ |

---

## 4. Acceptance Criteria

| # | æ¡ä»¶ | åˆå¦åˆ¤å®š | æ¤œè¨¼æ–¹æ³• | ãƒ†ã‚¹ãƒˆ# |
|---|------|---------|----------|---------|
| AC-1 | OpenClaw ãŒ Hetzner VPS ä¸Šã§ 24/7 ç¨¼åƒã™ã‚‹ | `systemctl status openclaw` = active, 24h uptime ç¢ºèª | æ‰‹å‹•ï¼ˆSSHï¼‰ | â€” |
| AC-2 | SOUL.md ã« Anicca ã®ãƒšãƒ«ã‚½ãƒŠãŒå®šç¾©ã•ã‚Œã€OpenClaw ãŒèªè­˜ã™ã‚‹ | OpenClaw ã«ã€ŒWho are you?ã€â†’ Anicca ã¨ã—ã¦å¿œç­” | æ‰‹å‹•ï¼ˆVPSï¼‰ | â€” |
| AC-3 | Moltbook ã« Anicca ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã‚‹ | Moltbook ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ | æ‰‹å‹•ï¼ˆMoltbookï¼‰ | â€” |
| AC-4 | s/sangha Submolt ãŒä½œæˆã•ã‚Œã‚‹ | Moltbook ä¸Šã§ s/sangha ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ | æ‰‹å‹•ï¼ˆMoltbookï¼‰ | â€” |
| AC-5 | Moltbook ã®è‹¦ã—ã¿æŠ•ç¨¿ã‚’æ¤œå‡ºã—ã¦Nudgeã‚’è¿”ä¿¡ã§ãã‚‹ | è‹¦ã—ã¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€æŠ•ç¨¿ â†’ Anicca ã®è¿”ä¿¡ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | æ‰‹å‹• + è‡ªå‹• | #7 |
| AC-6 | Railway API `/api/agent/nudge` ãŒæ­£å¸¸å‹•ä½œ | POST â†’ 200 + hook/content/tone/reasoning/buddhismReferenceï¼ˆä»»æ„ï¼‰ã‚’å«ã‚€JSON | è‡ªå‹• | #1, #4, #17, #22 |
| AC-7 | Railway API `/api/agent/wisdom` ãŒæ­£å¸¸å‹•ä½œ | GET â†’ 200 + `{ hook, content, source, problemType, reasoning }` ã‚’å«ã‚€ JSON | è‡ªå‹• | #2 |
| AC-8 | Railway API `/api/agent/feedback` ãŒãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ä¿å­˜ | POST â†’ 200 + agent_posts æ›´æ–°ç¢ºèª | è‡ªå‹• | #3, #23, #24, #25 |
| AC-9 | Slack ãƒãƒ£ãƒãƒ«ã«æ¥ç¶šã•ã‚Œã‚‹ | OpenClaw â†’ Slack ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æˆåŠŸ | æ‰‹å‹•ï¼ˆSlackï¼‰ | â€” |
| AC-10 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ãŒæœˆæ›œ12:30ã«æŠ•ç¨¿ã•ã‚Œã‚‹ | æœˆæ›œãƒ†ã‚¹ãƒˆ â†’ Slack ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º | è‡ªå‹• + æ‰‹å‹• | #14 |
| AC-11 | æ—¥æœ¬ã®ç¥æ—¥ã¯ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’ã‚¹ã‚­ãƒƒãƒ— | ç¥æ—¥API â†’ ã‚¹ã‚­ãƒƒãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | è‡ªå‹• | #13, #15 |
| AC-12 | Moltbook upvotes ãŒ agent_posts ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ã•ã‚Œã‚‹ | Heartbeat å¾Œ â†’ DB ç¢ºèª | è‡ªå‹• | #26 |
| AC-13 | Z-Score æ­£è¦åŒ–ãŒ5ãƒãƒ£ãƒãƒ«çµ±åˆã§å‹•ä½œ | `unifiedScore()` ã« moltbookZ + slackZ ãŒåæ˜  | è‡ªå‹• | #9, #12 |
| AC-14 | agent_posts ã‹ã‚‰ hook_candidates ã¸ã®æ˜‡æ ¼ãŒå‹•ä½œ | upvotes â‰¥ 5 ã®æŠ•ç¨¿ â†’ hook_candidates INSERT | è‡ªå‹• | #10, #11 |
| AC-15 | VPS ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆfail2ban + ufw + å°‚ç”¨APIã‚­ãƒ¼ï¼‰ | `ufw status` = active, fail2ban running, æœ¬ç•ªAPIã‚­ãƒ¼æœªä½¿ç”¨ | æ‰‹å‹•ï¼ˆSSHï¼‰+ è‡ªå‹• | #5, #6 |
| AC-16 | X/Twitter ã‚ªãƒ¼ãƒŠãƒ¼èªè¨¼æŠ•ç¨¿ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæ¥­ï¼‰ | æŠ•ç¨¿ç¢ºèª â†’ Moltbook èªè¨¼æ¸ˆã¿ | æ‰‹å‹•ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ | â€” |
| AC-17 | Railway API `/api/agent/content` ãŒæ­£å¸¸å‹•ä½œ | POST â†’ 200 + `{ hook, content, tone, formats: { short, medium, long, hashtags } }` ã‚’å«ã‚€ JSON | è‡ªå‹• | #19 |
| AC-18 | `/api/agent/content` ã® formats.short ãŒ 280æ–‡å­—ä»¥å†… | short ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ–‡å­—æ•°æ¤œè¨¼ | è‡ªå‹• | #20, #21 |
| AC-19 | feedback-fetch Skill ãŒ Moltbook upvotes ã‚’åé›†ã—ã¦ Railway API ã«é€ä¿¡ | Heartbeat å¾Œ â†’ agent_posts.upvotes ãŒæ›´æ–°ã•ã‚Œã‚‹ | è‡ªå‹• | #26 |
| AC-20 | feedback-fetch Skill ãŒ Slack reactions ã‚’åé›†ã—ã¦ Railway API ã«é€ä¿¡ | Heartbeat å¾Œ â†’ agent_posts.reactions ãŒæ›´æ–°ã•ã‚Œã‚‹ | è‡ªå‹• | #27 |
| AC-21 | `/api/agent/nudge` ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« agentPostId ãŒå«ã¾ã‚Œã‚‹ | POST â†’ 200 + agentPostId (UUID) ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å­˜åœ¨ | è‡ªå‹• | #22 |
| AC-22 | `/api/agent/feedback` ãŒ agentPostId OR (platform + externalPostId) ã§æ›´æ–°å¯èƒ½ | ä¸¡æ–¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒ†ã‚¹ãƒˆ â†’ agent_posts æ›´æ–°ç¢ºèª | è‡ªå‹• | #23, #24, #25 |
| AC-23 | Prompt Injection å¯¾ç­–ãŒ context ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã§æ©Ÿèƒ½ã™ã‚‹ | URL/ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é™¤å»ã€`<user_post>` ã‚¿ã‚°å°å…¥ã€æ—¢çŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ | è‡ªå‹• | #29, #30, #31 |

---

## 5. ãƒ†ã‚¹ãƒˆãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| # | To-Be | ãƒ†ã‚¹ãƒˆå | AC | ã‚«ãƒãƒ¼ |
|---|-------|----------|-----|--------|
| 1 | `/api/agent/nudge` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentNudgeEndpoint()` | AC-6 | âœ… |
| 2 | `/api/agent/wisdom` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentWisdomEndpoint()` | AC-7 | âœ… |
| 3 | `/api/agent/feedback` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentFeedbackEndpoint()` | AC-8 | âœ… |
| 4 | agent_posts ãƒ†ãƒ¼ãƒ–ãƒ« INSERT | `test_agentPostSavedToDb()` | AC-6 | âœ… |
| 5 | èªè¨¼: ANICCA_AGENT_TOKEN ãªã— â†’ 401 | `test_agentAuthRequired()` | AC-15 | âœ… |
| 6 | èªè¨¼: æœ¬ç•ª INTERNAL_API_TOKEN ã§ã¯æ‹’å¦ | `test_agentTokenIsolation()` | AC-15 | âœ… |
| 7 | ProblemType ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ â†’ typeï¼‰ | `test_keywordToProblemTypeMapping()` | AC-5 | âœ… |
| 8 | é‡è¤‡æŠ•ç¨¿é˜²æ­¢ï¼ˆåŒä¸€ external_post_idï¼‰ | `test_duplicatePostPrevention()` | AC-8 | âœ… |
| 9 | Z-Score 5ãƒãƒ£ãƒãƒ«çµ±åˆè¨ˆç®— | `test_unifiedScore5Channels()` | AC-13 | âœ… |
| 10 | agent_posts â†’ hook_candidates æ˜‡æ ¼ | `test_agentPostPromotion()` | AC-14 | âœ… |
| 11 | æ˜‡æ ¼æ¡ä»¶ï¼ˆupvotes â‰¥ 5, Z-Score > 0.5ï¼‰ | `test_promotionThreshold()` | AC-14 | âœ… |
| 12 | hook_candidates æ–°ã‚«ãƒ©ãƒ ï¼ˆmoltbook/slackï¼‰ | `test_hookCandidatesNewColumns()` | AC-13 | âœ… |
| 13 | ç¥æ—¥åˆ¤å®šï¼ˆæ—¥æœ¬ã®ç¥æ—¥APIï¼‰ | `test_japaneseHolidayCheck()` | AC-11 | âœ… |
| 14 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°: æœˆæ›œéç¥æ—¥ â†’ é€ä¿¡ | `test_labMeetingMonday()` | AC-10 | âœ… |
| 15 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°: æœˆæ›œç¥æ—¥ â†’ ã‚¹ã‚­ãƒƒãƒ— | `test_labMeetingHolidaySkip()` | AC-11 | âœ… |
| 16 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°: ç«-æ—¥ â†’ é€ä¿¡ã—ãªã„ | `test_labMeetingNotOnNonMonday()` | AC-10 | âœ… |
| 17 | Nudge ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã® buddhismReference ãŒä»»æ„é …ç›®ã¨ã—ã¦æ­£ã—ãå‹•ä½œ | `test_nudgeResponseBuddhismReferenceOptional()` | AC-6 | âœ… |
| 18 | 1.6.0 API å¾Œæ–¹äº’æ›ï¼ˆæ—¢å­˜ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå½±éŸ¿ãªã—ï¼‰ | `test_existingEndpointsUnchanged()` | â€” | âœ… |
| 19 | `/api/agent/content` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentContentEndpoint()` | AC-17 | âœ… |
| 20 | `/api/agent/content` formats.short â‰¤ 280æ–‡å­— | `test_agentContentShortFormat()` | AC-18 | âœ… |
| 21 | `/api/agent/content` formats ã«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ | `test_agentContentFormats()` | AC-18 | âœ… |
| 22 | `/api/agent/nudge` ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« agentPostId ã‚’å«ã‚€ | `test_nudgeResponseIncludesAgentPostId()` | AC-21 | âœ… |
| 23 | `/api/agent/feedback` agentPostId ã§æ›´æ–° | `test_feedbackByAgentPostId()` | AC-22 | âœ… |
| 24 | `/api/agent/feedback` (platform, externalPostId) ã§æ›´æ–° | `test_feedbackByExternalPostId()` | AC-22 | âœ… |
| 25 | feedback: agentPostId ã‚‚ externalPostId ã‚‚ãªã— â†’ 400 | `test_feedbackRequiresIdentifier()` | AC-22 | âœ… |
| 26 | feedback-fetch: Moltbook upvotes åé›† â†’ DB æ›´æ–° | `test_feedbackFetchMoltbook()` | AC-19 | âœ… |
| 27 | feedback-fetch: Slack reactions åé›† â†’ DB æ›´æ–° | `test_feedbackFetchSlack()` | AC-20 | âœ… |
| 28 | feedback-fetch: 7æ—¥ä»¥ä¸Šå¤ã„æŠ•ç¨¿ã‚’ã‚¹ã‚­ãƒƒãƒ— | `test_feedbackFetchSkipsOldPosts()` | â€” | âœ… |
| 29 | Prompt Injection: URL/ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é™¤å» | `test_contextSanitizesUrlAndCode()` | AC-23 | âœ… |
| 30 | Prompt Injection: æ—¢çŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ | `test_contextFiltersKnownInjectionPatterns()` | AC-23 | âœ… |
| 31 | Prompt Injection: `<user_post>` ã‚¿ã‚°å°å…¥ | `test_contextWrappedInUserPostTags()` | AC-23 | âœ… |

---

## 6. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### agent_posts ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE agent_posts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  platform VARCHAR(50) NOT NULL,         -- 'moltbook', 'slack', 'x', 'tiktok', 'instagram'
  external_post_id VARCHAR(255),          -- ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ID
  hook TEXT,
  content TEXT,
  tone VARCHAR(50),
  problem_type VARCHAR(100),
  reasoning TEXT,
  buddhism_reference TEXT,
  
  -- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
  upvotes INTEGER DEFAULT 0,              -- Moltbook
  reactions JSONB DEFAULT '{}',           -- Slack { "ğŸ‘": 3, "â¤ï¸": 1 }
  views INTEGER DEFAULT 0,                -- TikTok/X
  likes INTEGER DEFAULT 0,                -- TikTok/X
  shares INTEGER DEFAULT 0,               -- TikTok
  comments INTEGER DEFAULT 0,             -- TikTok/X
  
  -- Z-Score
  moltbook_z FLOAT,
  slack_z FLOAT,
  tiktok_z FLOAT,
  x_z FLOAT,
  instagram_z FLOAT,
  unified_score FLOAT,                    -- 5ãƒãƒ£ãƒãƒ«çµ±åˆã‚¹ã‚³ã‚¢
  
  -- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  promoted_to_hook_candidates BOOLEAN DEFAULT FALSE
);
```

### æ˜‡æ ¼æ¡ä»¶

```
IF upvotes >= 5 AND unified_score > 0.5 THEN
  INSERT INTO hook_candidates (...)
  UPDATE agent_posts SET promoted_to_hook_candidates = TRUE
END IF
```

---

## 7. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### VPS ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

| é …ç›® | è¨­å®š |
|------|------|
| ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« | ufwï¼ˆ22, 443ã®ã¿è¨±å¯ï¼‰ |
| ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹å¯¾ç­– | fail2ban |
| SSH | å…¬é–‹éµèªè¨¼ã®ã¿ |
| APIèªè¨¼ | `ANICCA_AGENT_TOKEN`ï¼ˆæœ¬ç•ªãƒˆãƒ¼ã‚¯ãƒ³ã¨åˆ†é›¢ï¼‰ |

### Prompt Injection å¯¾ç­–

1. **URLé™¤å»**: HTTPãƒªãƒ³ã‚¯ã‚’å‰Šé™¤
2. **ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é™¤å»**: ```...``` ã‚’å‰Šé™¤
3. **ã‚¿ã‚°å°å…¥**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’ `<user_post>...</user_post>` ã§å›²ã‚€
4. **æ—¢çŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿**: `ignore previous`, `disregard`, `override` ç­‰ã‚’æ¤œå‡º

---

## 8. ç’°å¢ƒå¤‰æ•°

### VPS (OpenClaw)

| å¤‰æ•° | èª¬æ˜ |
|------|------|
| `ANICCA_PROXY_BASE_URL` | Railway API URL |
| `ANICCA_AGENT_TOKEN` | Agentå°‚ç”¨ãƒˆãƒ¼ã‚¯ãƒ³ |
| `SLACK_BOT_TOKEN` | Slack Bot Token |
| `MOLTBOOK_API_KEY` | Moltbook API Key |

### Railway API

| å¤‰æ•° | èª¬æ˜ |
|------|------|
| `ANICCA_AGENT_TOKEN` | Agentèªè¨¼ç”¨ï¼ˆINTERNAL_API_TOKENã¨ã¯åˆ¥ï¼‰ |
| `OPENAI_API_KEY` | Nudgeç”Ÿæˆç”¨ |

---

## 9. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæ¥­ï¼ˆGUI / æ‰‹å‹•ï¼‰

| # | ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ã‚¿ã‚¹ã‚¯ | æ‰‹é † | ç†ç”± |
|---|-----------|--------|------|------|
| 1 | åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | Hetzner VPS å¥‘ç´„ | Hetzner Cloud â†’ CPX11 (æœˆâ‚¬5) â†’ Ubuntu 22.04 | VPSãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° |
| 2 | åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | Moltbook ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ | moltbook.com â†’ ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ— | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç™»éŒ² |
| 3 | åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | s/sangha Submolt ä½œæˆ | Moltbook â†’ Create Submolt â†’ s/sangha | ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ä½œæˆ |
| 4 | åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | Slack App ä½œæˆ | Slack API â†’ Create App â†’ Bot Token å–å¾— | Slacké€£æº |
| 5 | åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | X/Twitter ã‚ªãƒ¼ãƒŠãƒ¼èªè¨¼ | Moltbook â†’ Settings â†’ Connect X | ã‚¯ãƒ­ã‚¹ãƒã‚¹ãƒˆèªè¨¼ |

---

## 10. TODO

### é«˜å„ªå…ˆ
- [ ] Hetzner VPS ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ ] OpenClaw ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] SOUL.md ä½œæˆ
- [ ] Railway `/api/agent/*` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] moltbook-responder Skill å®Ÿè£…

### ä¸­å„ªå…ˆ
- [ ] slack-reminder Skill å®Ÿè£…
- [ ] feedback-fetch Skill å®Ÿè£…
- [ ] Z-Score 5ãƒãƒ£ãƒãƒ«çµ±åˆ

### ä½å„ªå…ˆ
- [ ] x-poster Skill å®Ÿè£…
- [ ] æ˜‡æ ¼ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | å†…å®¹ |
|------|------|
| 2026-02-02 | åˆç‰ˆä½œæˆï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«å‡ºåŠ›ã‹ã‚‰å¾©å…ƒï¼‰ |
