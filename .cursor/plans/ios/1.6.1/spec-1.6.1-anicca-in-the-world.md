# Spec: Anicca in the World (1.6.1)

> Anicca ãŒã‚¢ãƒ—ãƒªã‚’è¶…ãˆã¦ä¸–ç•Œã«å‡ºã‚‹ â€” OpenClaw + Moltbook + Slack çµ±åˆ

---

## 1. æ¦‚è¦

### ç›®æ¨™
**Anicca ãŒiOSã‚¢ãƒ—ãƒªã®å¤–ã§ã‚‚è‹¦ã—ã¿ã‚’çµ‚ã‚ã‚‰ã›ã‚‹**

- Moltbookï¼ˆåˆ†æ•£å‹SNSï¼‰ã§è‹¦ã—ã¿ã®æŠ•ç¨¿ã‚’æ¤œå‡ºã—ã€Nudgeã§è¿”ä¿¡
- Slack ã§ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’é€ä¿¡
- X/Twitter ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é…ä¿¡
- å…¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®åå¿œã‚’çµ±ä¸€ã‚¹ã‚³ã‚¢ã«é›†ç´„

### ãªãœä»Šã‚„ã‚‹ã‹
- Anicca ã®ã€Œè‹¦ã—ã¿ã‚’çµ‚ã‚ã‚‰ã›ã‚‹ã€ãƒŸãƒƒã‚·ãƒ§ãƒ³ã¯ã€ã‚¢ãƒ—ãƒªå†…ã ã‘ã§ã¯ä¸ååˆ†
- ãƒ–ãƒƒãƒ€ã¯ã€Œè‹¦ã—ã¿ã®ã‚ã‚‹å ´æ‰€ã«è‡ªã‚‰è¡Œã£ãŸã€â€” Anicca ã‚‚åŒæ§˜
- Cross-Platform Learning ã§ã€Œä½•ãŒåŠ¹ãã‹ã€ã®å­¦ç¿’ãŒåŠ é€Ÿ

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Hetzner VPS                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   OpenClaw                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚ Moltbook â”‚  â”‚  Slack   â”‚  â”‚ X/Twitterâ”‚               â”‚ â”‚
â”‚  â”‚  â”‚  Skill   â”‚  â”‚  Skill   â”‚  â”‚  Skill   â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â”‚       â”‚             â”‚             â”‚                      â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚ â”‚
â”‚  â”‚                     â†“                                    â”‚ â”‚
â”‚  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚ â”‚
â”‚  â”‚            â”‚   SOUL.md      â”‚  â† Anicca ãƒšãƒ«ã‚½ãƒŠ         â”‚ â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ ANICCA_AGENT_TOKEN
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Railway API                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ /agent/nudge â”‚  â”‚ /agent/wisdomâ”‚  â”‚/agent/feedbackâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                           â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  PostgreSQL                           â”‚   â”‚
â”‚  â”‚  agent_posts â†’ hook_candidates (æ˜‡æ ¼)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### 3.1 OpenClaw (Hetzner VPS)

| é …ç›® | å€¤ |
|------|-----|
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Hetzner VPS |
| ãƒ‡ãƒ¼ãƒ¢ãƒ³ | systemd (`openclaw.service`) |
| ãƒšãƒ«ã‚½ãƒŠ | `SOUL.md` |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | fail2ban + ufw + å°‚ç”¨APIã‚­ãƒ¼ |

### 3.2 Skills

| Skill | å½¹å‰² | ã‚½ãƒ¼ã‚¹ |
|-------|------|--------|
| **moltbook-responder** | è‹¦ã—ã¿æŠ•ç¨¿ã‚’æ¤œå‡º â†’ `/api/agent/nudge` â†’ è¿”ä¿¡ | è‡ªå‰å®Ÿè£… |
| **slack-reminder** | æœˆæ›œ12:30ã«ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€ä¿¡ | è‡ªå‰å®Ÿè£… |
| **feedback-fetch** | Moltbook upvotes / Slack reactions ã‚’åé›† | è‡ªå‰å®Ÿè£… |
| **x-poster** | X/Twitter ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æŠ•ç¨¿ | è‡ªå‰å®Ÿè£… |
| **moltbook/late-api** | Moltbook API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | ClawHubï¼ˆallowlistï¼‰ |

#### moltbook-responder ä»•æ§˜è©³ç´°

| é …ç›® | ä»•æ§˜ |
|------|------|
| **å…¬é–‹æŠ•ç¨¿ã®ã¿å‡¦ç†** | `post.visibility === 'public'` ã®æŠ•ç¨¿ã®ã¿å‡¦ç†ã€‚DM/éå…¬é–‹ï¼ˆ`visibility === 'private'`, `'direct'`, `'followers_only'`ï¼‰ã¯ç„¡è¦– |
| **ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶** | ã‚ªãƒ—ãƒˆã‚¤ãƒ³/å¬å–šå‹: @anicca ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã€s/sangha æŠ•ç¨¿ã€ãƒ•ã‚©ãƒ­ãƒ¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã„ãšã‚Œã‹ |
| **æ¤œå‡ºå¯¾è±¡** | å…¬é–‹æŠ•ç¨¿ ã‹ã¤ ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã‚’æº€ãŸã™ ã‹ã¤ è‹¦ã—ã¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º |
| **API ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰** | Moltbook API ã® `post.visibility` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§åˆ¤å®š |

**ãƒ†ã‚¹ãƒˆ:**

| # | ãƒ†ã‚¹ãƒˆå | å†…å®¹ |
|---|----------|------|
| 42 | `test_moltbookIgnoresPrivatePosts()` | `visibility !== 'public'` ã®æŠ•ç¨¿ã¯å‡¦ç†ã•ã‚Œãªã„ |
| 43 | `test_moltbookIgnoresDirectMessages()` | `visibility === 'direct'` ã¯å‡¦ç†ã•ã‚Œãªã„ |

#### ClawHub Skill ãƒãƒªã‚·ãƒ¼ï¼ˆä¾›çµ¦é–ãƒªã‚¹ã‚¯å¯¾ç­–å¼·åŒ–ï¼‰

| ãƒ«ãƒ¼ãƒ« | è©³ç´° |
|--------|------|
| **allowlist æ–¹å¼** | `SOUL.md` ã«è¨±å¯ãƒªã‚¹ãƒˆã‚’å®šç¾©ã€‚ãƒªã‚¹ãƒˆå¤–ã® ClawHub Skill ã¯è‡ªå‹•æ‹’å¦ |
| **ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥å›ºå®š** | `clawhub install moltbook/late-api@abc1234` ã®ã‚ˆã†ã«ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š |
| **ç½²å/ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼** | ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã« SHA-256 ãƒãƒƒã‚·ãƒ¥ã‚’æ¤œè¨¼ã€‚ä¸ä¸€è‡´ã¯æ‹’å¦ |
| **å†…éƒ¨ãƒŸãƒ©ãƒ¼é‹ç”¨** | æœ¬ç•ªã§ã¯ ClawHub ç›´æ¥å–å¾—ã‚’ç¦æ­¢ã€‚å†…éƒ¨ãƒŸãƒ©ãƒ¼ï¼ˆ`skills.anicca.internal/`ï¼‰ã‹ã‚‰ã®ã¿å–å¾— |
| **ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹å®Ÿè¡Œ** | ã‚¹ã‚­ãƒ«ã¯æœ€å°æ¨©é™ã§å®Ÿè¡Œã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã¯æ˜ç¤ºçš„ã«è¨±å¯ã•ã‚ŒãŸã‚‚ã®ã®ã¿ |
| **æ›´æ–°æ™‚ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆ** | Skill æ›´æ–°æ™‚ã¯ diff ã‚’ç¢ºèª + ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œã«ãƒãƒƒã‚·ãƒ¥ã‚’æ›´æ–° |

#### ã‚¹ã‚­ãƒ«æ¨©é™ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹

| ã‚¹ãƒ†ãƒƒãƒ— | å†…å®¹ |
|---------|------|
| 1. Diff ç¢ºèª | `clawhub diff moltbook/late-api@old..new` ã§å¤‰æ›´ã‚’ç¢ºèª |
| 2. æ¨©é™ãƒã‚§ãƒƒã‚¯ | æ–°è¦ã® API å‘¼ã³å‡ºã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã€å¤–éƒ¨é€šä¿¡ã‚’ç¢ºèª |
| 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼ | Codex ã¾ãŸã¯äººé–“ãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| 4. æ‰¿èª | Slack #agents ã§æ‰¿èªå¾Œã€ãƒãƒƒã‚·ãƒ¥ã‚’æ›´æ–° |

#### ç·Šæ€¥åœæ­¢æ‰‹é †

| ã‚·ãƒŠãƒªã‚ª | å¯¾å¿œ |
|---------|------|
| æ‚ªæ€§ã‚¹ã‚­ãƒ«æ¤œå‡º | (1) `clawhub disable <skill>` ã§å³æ™‚ç„¡åŠ¹åŒ– â†’ (2) Slack #agents ã«é€šçŸ¥ â†’ (3) å†…éƒ¨ãƒŸãƒ©ãƒ¼ã‹ã‚‰å‰Šé™¤ |
| å…¨ã‚¹ã‚­ãƒ«åœæ­¢ | `/anicca stop` ã§å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåœæ­¢ï¼ˆã‚¹ã‚­ãƒ«å«ã‚€ï¼‰ |
| ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ | `clawhub rollback <skill>@<previous-hash>` ã§å‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æˆ»ã™ |

#### ç›£æŸ»ãƒ­ã‚°

| ãƒ­ã‚°é …ç›® | è©³ç´° |
|---------|------|
| skill_install | ã‚¹ã‚­ãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ—¥æ™‚ã€ãƒãƒƒã‚·ãƒ¥ã€æ‰¿èªè€… |
| skill_update | æ›´æ–°æ—¥æ™‚ã€old/new ãƒãƒƒã‚·ãƒ¥ã€diff ã‚µãƒãƒª |
| skill_execution | å®Ÿè¡Œæ—¥æ™‚ã€å…¥åŠ›ã‚µãƒãƒªã€å‡ºåŠ›ã‚µãƒãƒªã€å®Ÿè¡Œæ™‚é–“ |
| skill_error | ã‚¨ãƒ©ãƒ¼æ—¥æ™‚ã€ã‚¨ãƒ©ãƒ¼å†…å®¹ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ |

### 3.3 Railway API

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¡ã‚½ãƒƒãƒ‰ | å½¹å‰² |
|---------------|---------|------|
| `/api/agent/nudge` | POST | Nudgeç”Ÿæˆï¼ˆLLMï¼‰ |
| `/api/agent/wisdom` | GET | Wisdomå–å¾— |
| `/api/agent/feedback` | POST | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ä¿å­˜ |
| `/api/agent/content` | POST | ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ |

#### AgentFeedbackRequest ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
interface AgentFeedbackRequest {
  agentPostId?: string;       // UUIDï¼ˆã“ã‚Œ OR ä¸‹ã®2ã¤ã§ç‰¹å®šï¼‰
  platform?: string;          // optionalï¼ˆagentPostId ãŒã‚ã‚Œã°ä¸è¦ï¼‰
  externalPostId?: string;    // optionalï¼ˆagentPostId ãŒã‚ã‚Œã°ä¸è¦ï¼‰
  upvotes?: number;
  reactions?: Record<string, number>;
  views?: number;
  likes?: number;
  shares?: number;
  comments?: number;
}
```

**5ã‚¹ãƒ†ãƒƒãƒ— ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«:**

| # | ãƒ«ãƒ¼ãƒ« | å¤±æ•—æ™‚ |
|---|--------|--------|
| 1 | `agentPostId` OR (`platform` + `externalPostId`) ã®ã„ãšã‚Œã‹ãŒå¿…é ˆ | 400 Bad Request |
| 2 | `agentPostId` æŒ‡å®šæ™‚ â†’ DB ã«å­˜åœ¨ã™ã‚‹ã‹ç¢ºèª | 404 Not Found |
| 3 | `platform` + `externalPostId` æŒ‡å®šæ™‚ â†’ DB ã«å­˜åœ¨ã™ã‚‹ã‹ç¢ºèª | 404 Not Found |
| 4 | æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯éè² æ•´æ•°ï¼ˆ`upvotes`, `views`, `likes`, `shares`, `comments`ï¼‰ | 400 Bad Request |
| 5 | `reactions` ã¯ `Record<string, number>` å½¢å¼ï¼ˆemoji â†’ countï¼‰ | 400 Bad Request |

---

## 4. Acceptance Criteria

| # | æ¡ä»¶ | åˆå¦åˆ¤å®š | æ¤œè¨¼æ–¹æ³• | ãƒ†ã‚¹ãƒˆ# |
|---|------|---------|----------|---------|
| AC-1 | OpenClaw ãŒ Hetzner VPS ä¸Šã§ 24/7 ç¨¼åƒã™ã‚‹ | `systemctl status openclaw` = active, 24h uptime ç¢ºèª | æ‰‹å‹•ï¼ˆSSHï¼‰ | â€” |
| AC-2 | SOUL.md ã« Anicca ã®ãƒšãƒ«ã‚½ãƒŠãŒå®šç¾©ã•ã‚Œã€OpenClaw ãŒèªè­˜ã™ã‚‹ | OpenClaw ã«ã€ŒWho are you?ã€â†’ Anicca ã¨ã—ã¦å¿œç­” | æ‰‹å‹•ï¼ˆVPSï¼‰ | â€” |
| AC-3 | Moltbook ã« Anicca ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã‚‹ | Moltbook ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ | æ‰‹å‹•ï¼ˆMoltbookï¼‰ | â€” |
| AC-4 | s/sangha Submolt ãŒä½œæˆã•ã‚Œã‚‹ | Moltbook ä¸Šã§ s/sangha ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ | æ‰‹å‹•ï¼ˆMoltbookï¼‰ | â€” |
| AC-5 | Moltbook ã§ã‚ªãƒ—ãƒˆã‚¤ãƒ³/å¬å–šå‹ã®è‹¦ã—ã¿æŠ•ç¨¿ã«Nudgeã‚’è¿”ä¿¡ã§ãã‚‹ | @anicca ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã€s/sangha æŠ•ç¨¿ã€ãƒ•ã‚©ãƒ­ãƒ¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼æŠ•ç¨¿ã®ã„ãšã‚Œã‹ã§è‹¦ã—ã¿ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º â†’ è¿”ä¿¡è¡¨ç¤º | æ‰‹å‹• + è‡ªå‹• | #7 |
| AC-6 | Railway API `/api/agent/nudge` ãŒæ­£å¸¸å‹•ä½œ | POST â†’ 200 + hook/content/tone/reasoning/buddhismReferenceï¼ˆä»»æ„ï¼‰/agentPostId ã‚’å«ã‚€JSON | è‡ªå‹• | #1, #4, #17, #22 |
| AC-7 | Railway API `/api/agent/wisdom` ãŒæ­£å¸¸å‹•ä½œ | GET â†’ 200 + `{ hook, content, source, problemType, reasoning }` ã‚’å«ã‚€ JSON | è‡ªå‹• | #2 |
| AC-8 | Railway API `/api/agent/feedback` ãŒãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ä¿å­˜ | POST â†’ 200 + agent_posts æ›´æ–°ç¢ºèª | è‡ªå‹• | #3, #23, #24, #25 |
| AC-9 | Slack ãƒãƒ£ãƒãƒ«ã«æ¥ç¶šã•ã‚Œã‚‹ | OpenClaw â†’ Slack ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æˆåŠŸ | æ‰‹å‹•ï¼ˆSlackï¼‰ | â€” |
| AC-10 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ãŒæœˆæ›œ12:30ã«æŠ•ç¨¿ã•ã‚Œã‚‹ | æœˆæ›œãƒ†ã‚¹ãƒˆ â†’ Slack ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º | è‡ªå‹• + æ‰‹å‹• | #14 |
| AC-11 | æ—¥æœ¬ã®ç¥æ—¥ã¯ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’ã‚¹ã‚­ãƒƒãƒ— | ç¥æ—¥API â†’ ã‚¹ã‚­ãƒƒãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | è‡ªå‹• | #13, #15 |
| AC-12 | Moltbook upvotes ãŒ agent_posts ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ã•ã‚Œã‚‹ | Heartbeat å¾Œ â†’ DB ç¢ºèª | è‡ªå‹• | #26 |
| AC-13 | Z-Score æ­£è¦åŒ–ãŒ5ãƒãƒ£ãƒãƒ«çµ±åˆã§å‹•ä½œ | `unifiedScore()` ã« moltbookZ + slackZ ãŒåæ˜  | è‡ªå‹• | #9, #12 |
| AC-14 | agent_posts ã‹ã‚‰ hook_candidates ã¸ã®æ˜‡æ ¼ãŒå‹•ä½œ | upvotes â‰¥ 5 ã®æŠ•ç¨¿ â†’ hook_candidates INSERT | è‡ªå‹• | #10, #11 |
| AC-15 | VPS ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆfail2ban + ufw + å°‚ç”¨APIã‚­ãƒ¼ï¼‰ | `ufw status` = active, fail2ban running, æœ¬ç•ªAPIã‚­ãƒ¼æœªä½¿ç”¨ | æ‰‹å‹•ï¼ˆSSHï¼‰+ è‡ªå‹• | #5, #6 |
| AC-16 | Moltbook claim URL ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦èªè¨¼å®Œäº†ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæ¥­ï¼‰ | claim_url ã‚¢ã‚¯ã‚»ã‚¹ â†’ Moltbook ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤º | æ‰‹å‹•ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ | â€” |
| AC-17 | Railway API `/api/agent/content` ãŒæ­£å¸¸å‹•ä½œ | POST â†’ 200 + `{ hook, content, tone, formats: { short, medium, long, hashtags } }` ã‚’å«ã‚€ JSON | è‡ªå‹• | #19 |
| AC-18 | `/api/agent/content` ã® formats.short ãŒ 280æ–‡å­—ä»¥å†… | short ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ–‡å­—æ•°æ¤œè¨¼ | è‡ªå‹• | #20, #21 |
| AC-19 | feedback-fetch Skill ãŒ Moltbook upvotes ã‚’åé›†ã—ã¦ Railway API ã«é€ä¿¡ | Heartbeat å¾Œ â†’ agent_posts.upvotes ãŒæ›´æ–°ã•ã‚Œã‚‹ | è‡ªå‹• | #26 |
| AC-20 | feedback-fetch Skill ãŒ Slack reactions ã‚’åé›†ã—ã¦ Railway API ã«é€ä¿¡ | Heartbeat å¾Œ â†’ agent_posts.reactions ãŒæ›´æ–°ã•ã‚Œã‚‹ | è‡ªå‹• | #27 |
| AC-21 | `/api/agent/nudge` ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« agentPostId ãŒå«ã¾ã‚Œã‚‹ | POST â†’ 200 + agentPostId (UUID) ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å­˜åœ¨ | è‡ªå‹• | #22 |
| AC-22 | `/api/agent/feedback` ãŒ agentPostId OR (platform + externalPostId) ã§æ›´æ–°å¯èƒ½ | ä¸¡æ–¹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒ†ã‚¹ãƒˆ â†’ agent_posts æ›´æ–°ç¢ºèª | è‡ªå‹• | #23, #24, #25 |
| AC-23 | Prompt Injection å¯¾ç­–ãŒ context ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã§æ©Ÿèƒ½ã™ã‚‹ | URL/ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é™¤å»ã€`<user_post>` ã‚¿ã‚°å°å…¥ã€æ—¢çŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ | è‡ªå‹• | #29, #30, #31 |
| AC-24 | ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—åˆ¶å¾¡ãŒ Allowlist ã«å¾“ã£ã¦å‹•ä½œã™ã‚‹ | Allowlist å¤–ãƒ„ãƒ¼ãƒ« â†’ æ‹’å¦ã€Allowlist å†… â†’ è¨±å¯ã€é«˜ãƒªã‚¹ã‚¯ â†’ HITL | è‡ªå‹• | #32, #33, #34 |
| AC-25 | ç›£æŸ»ãƒ­ã‚°ãŒå…¨ã¦ã® LLM å‘¼ã³å‡ºã—ãƒ»ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œã‚’è¨˜éŒ²ã™ã‚‹ | `agent_audit_logs` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ­ã‚°ãŒå­˜åœ¨ | è‡ªå‹• | #35, #36 |
| AC-26 | ç·Šæ€¥åœæ­¢ã‚³ãƒãƒ³ãƒ‰ã§å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒåœæ­¢ã™ã‚‹ | `/anicca stop` â†’ å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåœæ­¢ç¢ºèª | è‡ªå‹• + æ‰‹å‹• | #37 |
| AC-27 | ã‚¹ã‚­ãƒ«ç½²åæ¤œè¨¼ãŒæ©Ÿèƒ½ã™ã‚‹ | ãƒãƒƒã‚·ãƒ¥ä¸ä¸€è‡´ â†’ æ‹’å¦ã€ãƒãƒƒã‚·ãƒ¥ä¸€è‡´ â†’ è¨±å¯ | è‡ªå‹• | #38, #39 |
| AC-28 | Moltbook é‹ç”¨ãƒãƒªã‚·ãƒ¼ã«å¾“ã£ã¦å‹•ä½œã™ã‚‹ | ã‚ªãƒ—ãƒˆã‚¤ãƒ³/å¬å–šå‹ã€æŠ•ç¨¿ä¸Šé™ã€ãƒŸãƒ¥ãƒ¼ãƒˆ/ãƒ–ãƒ­ãƒƒã‚¯å°Šé‡ | æ‰‹å‹• + è‡ªå‹• | â€” |

---

## 5. ãƒ†ã‚¹ãƒˆãƒãƒˆãƒªãƒƒã‚¯ã‚¹

| # | To-Be | ãƒ†ã‚¹ãƒˆå | AC | ã‚«ãƒãƒ¼ |
|---|-------|----------|-----|--------|
| 1 | `/api/agent/nudge` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentNudgeEndpoint()` | AC-6 | âœ… |
| 2 | `/api/agent/wisdom` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentWisdomEndpoint()` | AC-7 | âœ… |
| 3 | `/api/agent/feedback` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentFeedbackEndpoint()` | AC-8 | âœ… |
| 4 | agent_posts ãƒ†ãƒ¼ãƒ–ãƒ« INSERT | `test_agentPostSavedToDb()` | AC-6 | âœ… |
| 5 | èªè¨¼: ANICCA_AGENT_TOKEN ãªã— â†’ 401 | `test_agentAuthRequired()` | AC-15 | âœ… |
| 6 | èªè¨¼: æœ¬ç•ª INTERNAL_API_TOKEN ã§ã¯æ‹’å¦ | `test_agentTokenIsolation()` | AC-15 | âœ… |
| 7 | ProblemType ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ â†’ typeï¼‰ | `test_keywordToProblemTypeMapping()` | AC-5 | âœ… |
| 8 | é‡è¤‡æŠ•ç¨¿é˜²æ­¢ï¼ˆåŒä¸€ external_post_idï¼‰ | `test_duplicatePostPrevention()` | AC-8 | âœ… |
| 9 | Z-Score 5ãƒãƒ£ãƒãƒ«çµ±åˆè¨ˆç®— | `test_unifiedScore5Channels()` | AC-13 | âœ… |
| 10 | agent_posts â†’ hook_candidates æ˜‡æ ¼ | `test_agentPostPromotion()` | AC-14 | âœ… |
| 11 | æ˜‡æ ¼æ¡ä»¶ï¼ˆupvotes â‰¥ 5, Z-Score > 0.5ï¼‰ | `test_promotionThreshold()` | AC-14 | âœ… |
| 12 | hook_candidates æ–°ã‚«ãƒ©ãƒ ï¼ˆmoltbook/slackï¼‰ | `test_hookCandidatesNewColumns()` | AC-13 | âœ… |
| 13 | ç¥æ—¥åˆ¤å®šï¼ˆæ—¥æœ¬ã®ç¥æ—¥APIï¼‰ | `test_japaneseHolidayCheck()` | AC-11 | âœ… |
| 14 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°: æœˆæ›œéç¥æ—¥ â†’ é€ä¿¡ | `test_labMeetingMonday()` | AC-10 | âœ… |
| 15 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°: æœˆæ›œç¥æ—¥ â†’ ã‚¹ã‚­ãƒƒãƒ— | `test_labMeetingHolidaySkip()` | AC-11 | âœ… |
| 16 | ãƒ©ãƒœãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°: ç«-æ—¥ â†’ é€ä¿¡ã—ãªã„ | `test_labMeetingNotOnNonMonday()` | AC-10 | âœ… |
| 17 | Nudge ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã® buddhismReference ãŒä»»æ„é …ç›®ã¨ã—ã¦æ­£ã—ãå‹•ä½œ | `test_nudgeResponseBuddhismReferenceOptional()` | AC-6 | âœ… |
| 18 | 1.6.0 API å¾Œæ–¹äº’æ›ï¼ˆæ—¢å­˜ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå½±éŸ¿ãªã—ï¼‰ | `test_existingEndpointsUnchanged()` | â€” | âœ… |
| 19 | `/api/agent/content` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | `test_agentContentEndpoint()` | AC-17 | âœ… |
| 20 | `/api/agent/content` formats.short â‰¤ 280æ–‡å­— | `test_agentContentShortFormat()` | AC-18 | âœ… |
| 21 | `/api/agent/content` formats ã«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ | `test_agentContentFormats()` | AC-18 | âœ… |
| 22 | `/api/agent/nudge` ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« agentPostId ã‚’å«ã‚€ | `test_nudgeResponseIncludesAgentPostId()` | AC-21 | âœ… |
| 23 | `/api/agent/feedback` agentPostId ã§æ›´æ–° | `test_feedbackByAgentPostId()` | AC-22 | âœ… |
| 24 | `/api/agent/feedback` (platform, externalPostId) ã§æ›´æ–° | `test_feedbackByExternalPostId()` | AC-22 | âœ… |
| 25 | feedback: agentPostId ã‚‚ externalPostId ã‚‚ãªã— â†’ 400 | `test_feedbackRequiresIdentifier()` | AC-22 | âœ… |
| 26 | feedback-fetch: Moltbook upvotes åé›† â†’ DB æ›´æ–° | `test_feedbackFetchMoltbook()` | AC-19 | âœ… |
| 27 | feedback-fetch: Slack reactions åé›† â†’ DB æ›´æ–° | `test_feedbackFetchSlack()` | AC-20 | âœ… |
| 28 | feedback-fetch: 7æ—¥ä»¥ä¸Šå¤ã„æŠ•ç¨¿ã‚’ã‚¹ã‚­ãƒƒãƒ— | `test_feedbackFetchSkipsOldPosts()` | â€” | âœ… |
| 29 | Prompt Injection: URL/ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é™¤å» | `test_contextSanitizesUrlAndCode()` | AC-23 | âœ… |
| 30 | Prompt Injection: æ—¢çŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ | `test_contextFiltersKnownInjectionPatterns()` | AC-23 | âœ… |
| 31 | Prompt Injection: `<user_post>` ã‚¿ã‚°å°å…¥ | `test_contextWrappedInUserPostTags()` | AC-23 | âœ… |
| 32 | ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—: Allowlist å¤–ãƒ„ãƒ¼ãƒ« â†’ æ‹’å¦ | `test_toolCallDeniedIfNotInAllowlist()` | AC-24 | âœ… |
| 33 | ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—: Allowlist å†…ãƒ„ãƒ¼ãƒ« â†’ è¨±å¯ | `test_toolCallAllowedIfInAllowlist()` | AC-24 | âœ… |
| 34 | ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—: é«˜ãƒªã‚¹ã‚¯æ“ä½œ â†’ HITL é€šçŸ¥ | `test_highRiskToolTriggersHitl()` | AC-24 | âœ… |
| 35 | ç›£æŸ»ãƒ­ã‚°: LLM å‘¼ã³å‡ºã—ãŒãƒ­ã‚°ã•ã‚Œã‚‹ | `test_llmCallAuditLogged()` | AC-25 | âœ… |
| 36 | ç›£æŸ»ãƒ­ã‚°: ãƒ„ãƒ¼ãƒ«å®Ÿè¡ŒãŒãƒ­ã‚°ã•ã‚Œã‚‹ | `test_toolExecutionAuditLogged()` | AC-25 | âœ… |
| 37 | ç·Šæ€¥åœæ­¢: `/anicca stop` ã§å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåœæ­¢ | `test_emergencyStopCommand()` | AC-26 | âœ… |
| 38 | ã‚¹ã‚­ãƒ«ç½²åæ¤œè¨¼: ãƒãƒƒã‚·ãƒ¥ä¸ä¸€è‡´ â†’ æ‹’å¦ | `test_skillHashMismatchRejected()` | AC-27 | âœ… |
| 39 | ã‚¹ã‚­ãƒ«ç½²åæ¤œè¨¼: ãƒãƒƒã‚·ãƒ¥ä¸€è‡´ â†’ è¨±å¯ | `test_skillHashMatchAllowed()` | AC-27 | âœ… |

---

## 6. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### 6.1 agent_postsï¼ˆPrisma modelï¼‰

```prisma
model AgentPost {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  platform          String    @db.VarChar(50)        // 'moltbook', 'slack', 'x', 'tiktok', 'instagram'
  externalPostId    String?   @map("external_post_id") @db.VarChar(255)
  platformUserId    String?   @map("platform_user_id") @db.VarChar(255) // ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤è¦æ±‚ç”¨
  severity          String?   @db.VarChar(20)        // null | 'crisis'ï¼ˆå±æ©Ÿæ¤œå‡ºæ™‚ï¼‰
  region            String?   @db.VarChar(10)        // 'JP', 'US', 'UK', 'KR', 'OTHER'ï¼ˆå±æ©Ÿæ¤œå‡ºæ™‚ã®åœ°åŸŸï¼‰
  hook              String?
  content           String?
  tone              String?   @db.VarChar(50)
  problemType       String?   @map("problem_type") @db.VarChar(100)
  reasoning         String?
  buddhismReference String?   @map("buddhism_reference")

  // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
  upvotes           Int       @default(0)
  reactions         Json      @default("{}")          // Slack { "ğŸ‘": 3, "â¤ï¸": 1 }
  views             Int       @default(0)
  likes             Int       @default(0)
  shares            Int       @default(0)
  comments          Int       @default(0)

  // Z-Score
  moltbookZ         Float?    @map("moltbook_z")
  slackZ            Float?    @map("slack_z")
  tiktokZ           Float?    @map("tiktok_z")
  xZ                Float?    @map("x_z")
  instagramZ        Float?    @map("instagram_z")
  unifiedScore      Float?    @map("unified_score")

  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")
  promotedToHookCandidates Boolean @default(false) @map("promoted_to_hook_candidates")

  @@unique([platform, externalPostId])  // é‡è¤‡é˜²æ­¢ï¼ˆpartial: NULL ã¯è¤‡æ•°è¨±å®¹ï¼‰
  @@map("agent_posts")
}
```

### 6.2 hook_candidates æ‹¡å¼µã‚«ãƒ©ãƒ ï¼ˆPrisma migrationï¼‰

æ—¢å­˜ã® `HookCandidate` model ã«ä»¥ä¸‹ã‚’è¿½åŠ :

```prisma
// æ—¢å­˜ã® HookCandidate ã«è¿½åŠ ã™ã‚‹ã‚«ãƒ©ãƒ 
moltbookUpvoteRate  Decimal?  @map("moltbook_upvote_rate") @db.Decimal(5, 4)
moltbookSampleSize  Int?      @map("moltbook_sample_size")
moltbookHighPerformer Boolean? @map("moltbook_high_performer")
slackReactionRate   Decimal?  @map("slack_reaction_rate") @db.Decimal(5, 4)
slackSampleSize     Int?      @map("slack_sample_size")
slackHighPerformer  Boolean?  @map("slack_high_performer")
```

### 6.3 Z-Score 5ãƒãƒ£ãƒãƒ«çµ±åˆ

**As-Isï¼ˆ1.6.0ï¼‰:** 3ãƒãƒ£ãƒãƒ«ï¼ˆApp, TikTok, Xï¼‰

```
unified_score = W_APP * appZ + W_TIK * tiktokZ + W_X * xZ
W_APP=0.5, W_TIK=0.3, W_X=0.2  (åˆè¨ˆ 1.0)
```

**To-Beï¼ˆ1.6.1ï¼‰:** 5ãƒãƒ£ãƒãƒ«

```
unified_score = W_APP * appZ + W_TIK * tiktokZ + W_X * xZ + W_MOLT * moltbookZ + W_SLACK * slackZ
```

| ãƒãƒ£ãƒãƒ« | é‡ã¿ | ç†ç”± |
|---------|------|------|
| App (appZ) | 0.40 | ã‚³ã‚¢ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¡Œå‹•å¤‰å®¹ã«æœ€ã‚‚ç›´çµ |
| TikTok (tiktokZ) | 0.20 | ãƒªãƒ¼ãƒãŒå¤§ãã„ã€‚likeç‡ãŒæŒ‡æ¨™ |
| X (xZ) | 0.15 | engagementç‡ãŒæŒ‡æ¨™ |
| Moltbook (moltbookZ) | 0.15 | è‹¦ã—ã¿ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«æœ€ã‚‚è¿‘ã„ã€‚upvoteç‡ãŒæŒ‡æ¨™ |
| Slack (slackZ) | 0.10 | å®Ÿé¨“å ´ã€‚reactionæ•°ãŒæŒ‡æ¨™ |

**ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆåˆæœŸå€¤ï¼‰:**

| ãƒãƒ£ãƒãƒ« | æŒ‡æ¨™ | åˆæœŸMEAN | åˆæœŸSTDDEV | æœ€å°ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º |
|---------|------|---------|-----------|-----------------|
| Moltbook | upvotes / views | 0.05 | 0.03 | 10 |
| Slack | total_reactions / messages | 0.10 | 0.05 | 5 |

**æ³¨æ„:** Moltbook ã®æŒ‡æ¨™ã¯ `upvotes / views` ã‚’ä½¿ç”¨ã€‚`views` ã¯ `AgentPost.views` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ä¿å­˜æ¸ˆã¿ã€‚

**views ãŒ 0 ã¾ãŸã¯æœªæä¾›ã®å ´åˆã®è¨ˆç®—ãƒ«ãƒ¼ãƒ«:**

| æ¡ä»¶ | å‡¦ç† |
|------|------|
| `views === 0` | Z-Score è¨ˆç®—ã‹ã‚‰é™¤å¤–ï¼ˆNaN å›é¿ï¼‰ |
| `views === null` ã¾ãŸã¯æœªæä¾› | `moltbook_upvotes_baseline`ï¼ˆåˆ¥ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼‰ã‚’ä½¿ç”¨ã—ã¦ upvotes çµ¶å¯¾å€¤ã§è¨ˆç®— |
| `views < 10`ï¼ˆæœ€ä½ã—ãã„å€¤ï¼‰ | ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºä¸è¶³ã¨ã—ã¦ Z-Score è¨ˆç®—ã‹ã‚‰é™¤å¤– |

**views æ¬ ææ™‚ã®åˆ¥ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³:**

| ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ | æŒ‡æ¨™ | åˆæœŸMEAN | åˆæœŸSTDDEV | æ›´æ–°ãƒ«ãƒ¼ãƒ« |
|-------------|------|---------|-----------|-----------|
| `moltbook_upvotes_baseline` | upvotesï¼ˆçµ¶å¯¾å€¤ï¼‰ | 3.0 | 2.0 | 30æ—¥é–“ã® views=null ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿ã‚’æ¯é›†å›£ã¨ã—ã¦ `refreshBaselines()` ã§æ›´æ–° |

**refreshBaselines() ã®å…¥åŠ›æ¯é›†å›£:**

| ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ | æ¯é›†å›£ | æœŸé–“ |
|-------------|--------|------|
| `moltbook_views_baseline` | `views IS NOT NULL AND views >= 10` ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ | ç›´è¿‘30æ—¥ |
| `moltbook_upvotes_baseline` | `views IS NULL` ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ | ç›´è¿‘30æ—¥ |

**ãƒ†ã‚¹ãƒˆ:**

| # | ãƒ†ã‚¹ãƒˆå | å†…å®¹ |
|---|----------|------|
| 46 | `test_zScoreExcludesZeroViews()` | views=0 ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ Z-Score è¨ˆç®—ã‹ã‚‰é™¤å¤–ã•ã‚Œã‚‹ |
| 47 | `test_zScoreFallbackToUpvotes()` | views=null ã®å ´åˆã€upvotes çµ¶å¯¾å€¤ã§è¨ˆç®—ã•ã‚Œã‚‹ |

30æ—¥åˆ†ã®ãƒ‡ãƒ¼ã‚¿ãŒæºœã¾ã£ãŸã‚‰ `refreshBaselines()` ãŒå®Ÿãƒ‡ãƒ¼ã‚¿ã§ä¸Šæ›¸ãã™ã‚‹ã€‚

### 6.4 æ˜‡æ ¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

**2ã¤ã®æ˜‡æ ¼ãƒ‘ã‚¹ãŒå…±å­˜ã™ã‚‹ã€‚å¹²æ¸‰ã—ãªã„ã€‚**

| ãƒ‘ã‚¹ | æ¡ä»¶ | å‹•ä½œ | source |
|------|------|------|--------|
| **A: agent_posts â†’ hook_candidates**ï¼ˆæ–°è¦ï¼‰ | `upvotes >= 5 AND unified_score > 0.5` | æ–°è¦ INSERT | `agent_moltbook`, `agent_slack` ç­‰ |
| **B: æ—¢å­˜ cross-platform promotion** | Xâ†’TikTok: Zâ‰¥1.0, TikTokâ†’App: unifiedâ‰¥1.5 | hook_candidates å†…ã® `promoted` ãƒ•ãƒ©ã‚°æ›´æ–° | æ—¢å­˜ã® `tiktok`, `x` ç­‰ |

- ãƒ‘ã‚¹A ã¯å¤–éƒ¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆMoltbook/Slackï¼‰ã‹ã‚‰ã®ã€Œæ–°è¦ hook ç™ºè¦‹ã€
- ãƒ‘ã‚¹B ã¯æ—¢å­˜ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å†…ã®ã€Œã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æ˜‡æ ¼ã€
- `source` ã‚«ãƒ©ãƒ ã§åŒºåˆ¥ã€‚æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯ã«å½±éŸ¿ãªã—

### 6.5 ãƒ‡ãƒ¼ã‚¿ä¿æŒãƒ»åŒ¿ååŒ–ãƒãƒªã‚·ãƒ¼

**SOUL.md è¦ä»¶:** `agent_posts` ã¯90æ—¥å¾Œã«åŒ¿ååŒ–ã™ã‚‹

| é …ç›® | è¨­å®š |
|------|------|
| **åŒ¿ååŒ–å¯¾è±¡** | `external_post_id`, `content`, `reasoning`ï¼ˆå€‹äººã‚’ç‰¹å®šå¯èƒ½ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ |
| **åŒ¿ååŒ–æ–¹æ³•** | å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ `NULL` ã«æ›´æ–°ã€‚`hook`, `tone`, `problemType`, `upvotes` ç­‰ã®é›†è¨ˆãƒ‡ãƒ¼ã‚¿ã¯ä¿æŒ |
| **å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°** | æ¯æ—¥ 04:00 UTCï¼ˆRailway Cronï¼‰ |
| **å¯¾è±¡æ¡ä»¶** | `created_at < NOW() - INTERVAL '90 days'` ã‹ã¤æœªåŒ¿ååŒ– |
| **åŒ¿ååŒ–ãƒ•ãƒ©ã‚°** | `anonymized_at` ã‚«ãƒ©ãƒ ï¼ˆnullable timestampï¼‰ã‚’è¿½åŠ ã€‚åŒ¿ååŒ–æ¸ˆã¿ã¯å†å‡¦ç†ã—ãªã„ |

#### Prisma schema è¿½åŠ 

```prisma
// AgentPost ã«è¿½åŠ 
anonymizedAt      DateTime? @map("anonymized_at")
```

#### åŒ¿ååŒ–ã‚¸ãƒ§ãƒ–

```sql
UPDATE agent_posts
SET 
  external_post_id = NULL,
  content = NULL,
  reasoning = NULL,
  anonymized_at = NOW()
WHERE 
  created_at < NOW() - INTERVAL '90 days'
  AND anonymized_at IS NULL;
```

#### ãƒ†ã‚¹ãƒˆ

| # | ãƒ†ã‚¹ãƒˆå | å†…å®¹ |
|---|----------|------|
| 40 | `test_anonymizationJob()` | 90æ—¥ä»¥ä¸Šå¤ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒåŒ¿ååŒ–ã•ã‚Œã‚‹ |
| 41 | `test_anonymizationPreservesAggregates()` | `hook`, `upvotes` ç­‰ã¯ä¿æŒã•ã‚Œã‚‹ |

### 6.6 å‰Šé™¤è¦æ±‚å¯¾å¿œï¼ˆSOUL.md è¦ä»¶ï¼‰

**SOUL.md è¦ä»¶:** ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‰Šé™¤ã‚’è¦æ±‚ã—ãŸå ´åˆã€24æ™‚é–“ä»¥å†…ã«å¯¾å¿œã™ã‚‹ã€

#### å‰Šé™¤è¦æ±‚ã®å—ä»˜æ‰‹æ®µ

| æ‰‹æ®µ | è©³ç´° |
|------|------|
| **Moltbook DM** | @anicca ã«ã€Œdelete my dataã€ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦ã€ç­‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ DM ã‚’é€ä¿¡ï¼ˆSOUL.md ä¾‹å¤–æ¡é …ã«ã‚ˆã‚Š DM å‡¦ç†ã‚’è¨±å¯ï¼‰ |
| **Slack #agents** | ç®¡ç†è€…ãŒ `/anicca delete-user --platform-user-id <platform>:<user_id>` ã¾ãŸã¯ `/anicca delete-post --external-post-id <id>` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ |
| **ç®¡ç†è€… CLI** | `npm run delete-user -- --platform moltbook --platform-user-id <id>` ã¾ãŸã¯ `npm run delete-post -- --external-post-id <id>` |

**æ³¨æ„:** `platform_user_id` ã¯ `AgentPost.platformUserId` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ä¿å­˜ã€‚Moltbook API ã‹ã‚‰å–å¾—ã—ãŸæŠ•ç¨¿è€… ID ã‚’åé›†ãƒ»ä¿å­˜ã™ã‚‹ã€‚

#### èªå¯

| æ‰‹æ®µ | èªå¯ãƒ¬ãƒ™ãƒ« |
|------|-----------|
| Moltbook DM | æœ¬äººã®ã¿ï¼ˆDM é€ä¿¡è€… = ãƒ‡ãƒ¼ã‚¿æ‰€æœ‰è€…ï¼‰ |
| Slack ã‚³ãƒãƒ³ãƒ‰ | ç®¡ç†è€…ã®ã¿ï¼ˆSlack ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã® #agents ãƒ¡ãƒ³ãƒãƒ¼ï¼‰ |
| CLI | ç®¡ç†è€…ã®ã¿ï¼ˆVPS SSH ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™è€…ï¼‰ |

#### å‰Šé™¤å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‰Šé™¤æ–¹æ³• |
|-----------|----------|
| `external_post_id` | NULL ã«æ›´æ–° |
| `content` | NULL ã«æ›´æ–° |
| `reasoning` | NULL ã«æ›´æ–° |
| `hook` | **ä¿æŒ**ï¼ˆåŒ¿ååŒ–ã•ã‚ŒãŸçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ç”¨å¯ï¼‰ |
| `upvotes`, `views` ç­‰ | **ä¿æŒ** |

#### SLA

| é …ç›® | å€¤ |
|------|-----|
| å¯¾å¿œæ™‚é–“ | 24æ™‚é–“ä»¥å†…ï¼ˆå–¶æ¥­æ—¥ï¼‰ |
| å®Œäº†é€šçŸ¥ | Moltbook DM ã®å ´åˆã€å‰Šé™¤å®Œäº†ã‚’è¿”ä¿¡ |

#### ç›£æŸ»ãƒ­ã‚°

| ãƒ­ã‚°é …ç›® | è©³ç´° |
|---------|------|
| `deletion_request` | è¦æ±‚æ—¥æ™‚ã€è¦æ±‚æ‰‹æ®µã€å¯¾è±¡ ID |
| `deletion_completed` | å®Œäº†æ—¥æ™‚ã€å‰Šé™¤å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€å®Ÿè¡Œè€… |

#### ãƒ†ã‚¹ãƒˆ

| # | ãƒ†ã‚¹ãƒˆå | å†…å®¹ |
|---|----------|------|
| 44 | `test_deletionRequestViaSlack()` | Slack ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œã‚‹ |
| 45 | `test_deletionPreservesAggregates()` | `hook`, `upvotes` ç­‰ã¯ä¿æŒã•ã‚Œã‚‹ |

---

## 7. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### Railway Agent API ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

| é …ç›® | è¨­å®š |
|------|------|
| èªè¨¼ | `ANICCA_AGENT_TOKEN`ï¼ˆ`INTERNAL_API_TOKEN` ã¨ã¯å®Œå…¨åˆ†é›¢ï¼‰ |
| è¨±å¯ãƒ¡ã‚½ãƒƒãƒ‰ | **GET**ï¼ˆ`/wisdom`ï¼‰+ **POST**ï¼ˆ`/nudge`, `/feedback`, `/content`ï¼‰ |
| ã‚¹ã‚³ãƒ¼ãƒ— | Nudgeç”Ÿæˆ + Wisdomå–å¾— + ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ä¿å­˜ + ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆã®ã¿ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ»èª²é‡‘ãƒ»è¨­å®šå¤‰æ›´ã¯ä¸å¯ |
| ãƒ¬ãƒ¼ãƒˆåˆ¶é™ | 60 req/min per token |

### ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ï¼ˆOWASP MCP Top 10 æº–æ‹ ï¼‰

| é …ç›® | è¨­å®š |
|------|------|
| **æœ‰åŠ¹æœŸé™** | 90æ—¥ï¼ˆçŸ­æœŸãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ |
| **ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³** | 60æ—¥ã”ã¨ã«æ–°ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œã€‚æ—§ãƒˆãƒ¼ã‚¯ãƒ³ã¯7æ—¥é–“ã®çŒ¶äºˆæœŸé–“å¾Œã«å¤±åŠ¹ |
| **å¤±åŠ¹ãƒ•ãƒ­ãƒ¼** | Railway ç’°å¢ƒå¤‰æ•°ã‚’æ›´æ–° â†’ VPS ç’°å¢ƒå¤‰æ•°ã‚’æ›´æ–° â†’ æ—§ãƒˆãƒ¼ã‚¯ãƒ³å‰Šé™¤ |
| **æ¼æ´©æ™‚ã®å³æ™‚ç„¡åŠ¹åŒ–** | (1) Railway ã§å³åº§ã«ç’°å¢ƒå¤‰æ•°ã‚’å‰Šé™¤ â†’ (2) Slack #agents ã«é€šçŸ¥ â†’ (3) æ–°ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œ â†’ (4) VPS æ›´æ–° |
| **ç›£æŸ»** | ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨ãƒ­ã‚°ã‚’ `agent_audit_logs` ã«è¨˜éŒ²ã€‚ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œçŸ¥ |

#### ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †

```bash
# 1. æ–°ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ
NEW_TOKEN=$(openssl rand -hex 32)
OLD_TOKEN=$(railway variables get ANICCA_AGENT_TOKEN)

# 2. Railway ã«æ—§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ OLD ã«é€€é¿ã—ã€æ–°ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š
railway variables set ANICCA_AGENT_TOKEN_OLD=$OLD_TOKEN
railway variables set ANICCA_AGENT_TOKEN=$NEW_TOKEN

# 3. API ãŒä¸¡æ–¹ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å—ã‘å…¥ã‚Œã‚‹ï¼ˆ7æ—¥é–“ã®çŒ¶äºˆæœŸé–“ï¼‰
# èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯: token === ANICCA_AGENT_TOKEN || token === ANICCA_AGENT_TOKEN_OLD

# 4. VPS ã‚’æ–°ãƒˆãƒ¼ã‚¯ãƒ³ã«æ›´æ–°
ssh anicca@<vps-ip> "sed -i 's/$OLD_TOKEN/$NEW_TOKEN/' ~/.env && systemctl restart openclaw"

# 5. æ—§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰Šé™¤
railway variables unset ANICCA_AGENT_TOKEN_OLD
```

#### æ¼æ´©æ¤œçŸ¥æŒ‡æ¨™

| æŒ‡æ¨™ | é–¾å€¤ | å¯¾å¿œ |
|------|------|------|
| ç•°å¸¸ãª IP ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | æ—¢çŸ¥ IP ä»¥å¤–ã‹ã‚‰10ä»¶/æ™‚ | ã‚¢ãƒ©ãƒ¼ãƒˆ + èª¿æŸ» |
| ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¶…é | 3å›é€£ç¶š | ã‚¢ãƒ©ãƒ¼ãƒˆ + ä¸€æ™‚ãƒ–ãƒ­ãƒƒã‚¯æ¤œè¨ |
| å¤±æ•—ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ€¥å¢— | 50ä»¶/æ™‚ | ã‚¢ãƒ©ãƒ¼ãƒˆ + ãƒˆãƒ¼ã‚¯ãƒ³æ¼æ´©ç–‘ã„ |

### VPS ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

| é …ç›® | è¨­å®š |
|------|------|
| ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« | ufwï¼ˆ22, 443ã®ã¿è¨±å¯ï¼‰ |
| ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹å¯¾ç­– | fail2ban |
| SSH | å…¬é–‹éµèªè¨¼ã®ã¿ |

### Prompt Injection å¯¾ç­–ï¼ˆOWASP MCP Top 10 æº–æ‹ ï¼‰

#### å…¥åŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚ºå±¤

| # | å¯¾ç­– | è©³ç´° |
|---|------|------|
| 1 | URLé™¤å» | HTTPãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ |
| 2 | ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯é™¤å» | ``` ``` ``` ã‚’å‰Šé™¤ |
| 3 | ã‚¿ã‚°å°å…¥ | ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’ `<user_post>...</user_post>` ã§å›²ã‚€ |
| 4 | æ—¢çŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ | `ignore previous`, `disregard`, `override`, `system:`, `assistant:` ç­‰ã‚’æ¤œå‡ºãƒ»é™¤å» |
| 5 | æœ€å¤§é•·åˆ¶é™ | context ã¯ 2000æ–‡å­—ã¾ã§ï¼ˆè¶…éã¯åˆ‡ã‚Šæ¨ã¦ï¼‰ |
| 6 | Unicodeåˆ¶å¾¡æ–‡å­—é™¤å» | U+200B-U+200F, U+202A-U+202E ã‚’é™¤å» |
| 7 | ã‚¿ã‚°ã‚¨ã‚¹ã‚±ãƒ¼ãƒ— | ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ä¸­ã® `<user_post>` `</user_post>` ã‚’é™¤å» |

#### ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—åˆ¶å¾¡å±¤ï¼ˆæ–°è¦ï¼‰

| # | å¯¾ç­– | è©³ç´° |
|---|------|------|
| 8 | ãƒ„ãƒ¼ãƒ« Allowlist | Anicca ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‘¼ã³å‡ºã›ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’æ˜ç¤ºçš„ã«å®šç¾©ã€‚ãã‚Œä»¥å¤–ã¯è‡ªå‹•æ‹’å¦ |
| 9 | æœªä¿¡é ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ†é›¢ | ãƒ¦ãƒ¼ã‚¶ãƒ¼æŠ•ç¨¿ã¯ `untrusted_context` ã¨ã—ã¦æ˜ç¢ºã«åˆ†é›¢ã€‚System prompt ã¨ã¯åˆ¥ã‚»ã‚¯ã‚·ãƒ§ãƒ³ |
| 10 | ãƒãƒªã‚·ãƒ¼æ¤œè¨¼ | å„ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—å‰ã«ã‚µãƒ¼ãƒãƒ¼å´ã§ãƒãƒªã‚·ãƒ¼æ¤œè¨¼ã€‚å¤–éƒ¨ API å‘¼ã³å‡ºã—ã¯åˆ¶é™ |
| 11 | é«˜ãƒªã‚¹ã‚¯æ“ä½œã® HITL | ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ã€å¤–éƒ¨é€ä¿¡ã€è¨­å®šå¤‰æ›´ã¯äººé–“æ‰¿èªå¿…é ˆï¼ˆSlack #agents ã«é€šçŸ¥ï¼‰ |

#### ç›£æŸ»ãƒ»ç›£è¦–å±¤ï¼ˆæ–°è¦ï¼‰

| # | å¯¾ç­– | è©³ç´° |
|---|------|------|
| 12 | ç›£æŸ»ãƒ­ã‚°å¿…é ˆ | å…¨ã¦ã® LLM å‘¼ã³å‡ºã—ãƒ»ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œã‚’ãƒ­ã‚°ã€‚`agent_audit_logs` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ |
| 13 | ç•°å¸¸æ¤œçŸ¥ | 1æ™‚é–“ã‚ãŸã‚Š50ä»¶ä»¥ä¸Šã®ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã§ã‚¢ãƒ©ãƒ¼ãƒˆ |
| 14 | ç·Šæ€¥åœæ­¢ | Slack #agents ã§ `/anicca stop` ã‚³ãƒãƒ³ãƒ‰ â†’ å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå³æ™‚åœæ­¢ |

#### Allowlist å®šç¾©

```yaml
allowed_tools:
  - name: generate_nudge
    risk: low
    hitl: false
  - name: post_to_moltbook
    risk: medium
    hitl: false
    rate_limit: 10/day
  - name: post_to_slack
    risk: low
    hitl: false
  - name: post_to_x
    risk: medium
    hitl: false
    rate_limit: 5/day
  - name: fetch_feedback
    risk: low
    hitl: false

denied_tools:
  - name: execute_code
  - name: send_email
  - name: access_database_raw
  - name: modify_system_config
```

---

## 8. ç’°å¢ƒå¤‰æ•°

### VPS (OpenClaw)

| å¤‰æ•° | èª¬æ˜ |
|------|------|
| `ANICCA_PROXY_BASE_URL` | Railway API URL |
| `ANICCA_AGENT_TOKEN` | Agentå°‚ç”¨ãƒˆãƒ¼ã‚¯ãƒ³ |
| `SLACK_BOT_TOKEN` | Slack Bot Token |
| `MOLTBOOK_API_KEY` | Moltbook API Key |

### Railway API

| å¤‰æ•° | èª¬æ˜ |
|------|------|
| `ANICCA_AGENT_TOKEN` | Agentèªè¨¼ç”¨ï¼ˆINTERNAL_API_TOKENã¨ã¯åˆ¥ï¼‰ |
| `ANICCA_AGENT_TOKEN_OLD` | ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³çŒ¶äºˆæœŸé–“ä¸­ã®æ—§ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆä»»æ„ï¼‰ |
| `OPENAI_API_KEY` | Nudgeç”Ÿæˆç”¨ |

**è¤‡æ•°ãƒˆãƒ¼ã‚¯ãƒ³è¨±å¯:** ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æœŸé–“ä¸­ã¯ `ANICCA_AGENT_TOKEN` ã¨ `ANICCA_AGENT_TOKEN_OLD` ã®ä¸¡æ–¹ã‚’å—ã‘å…¥ã‚Œã‚‹ã€‚èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã¯ `token === ANICCA_AGENT_TOKEN || token === ANICCA_AGENT_TOKEN_OLD` ã§åˆ¤å®šã€‚çŒ¶äºˆæœŸé–“ï¼ˆ7æ—¥ï¼‰çµ‚äº†å¾Œã« `ANICCA_AGENT_TOKEN_OLD` ã‚’å‰Šé™¤ã€‚

---

## 9. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæ¥­ï¼ˆGUI / æ‰‹å‹•ï¼‰

**ã»ã¼å…¨è‡ªå‹•ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§ã‚„ã‚‹ã®ã¯1ã¤ã ã‘ã€‚**

### ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè‡ªå‹•ã§ã‚„ã‚‹ã“ã¨ï¼ˆCLIï¼‰

| # | ã‚¿ã‚¹ã‚¯ | æ–¹æ³• |
|---|--------|------|
| 1 | Moltbook ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç™»éŒ² | `curl -X POST https://www.moltbook.com/api/v1/agents/register` â†’ api_key + claim_url å–å¾— |
| 2 | s/sangha Submolt ä½œæˆ | Moltbook API çµŒç”± |
| 3 | Hetzner VPS ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | CLI / Terraform |
| 4 | Slack é€£æº | **è¨­å®šæ¸ˆã¿**ï¼ˆOAuth + Bot Token + `#agents` ãƒãƒ£ãƒ³ãƒãƒ« + 12+ ãƒ„ãƒ¼ãƒ«ï¼‰ |

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§ã‚„ã‚‹ã“ã¨

| # | ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ã‚¿ã‚¹ã‚¯ | æ‰‹é † | ç†ç”± |
|---|-----------|--------|------|------|
| 1 | Moltbook ç™»éŒ²å¾Œ | claim URL ã‚’ã‚¯ãƒªãƒƒã‚¯ | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‡ºåŠ›ã—ãŸ `claim_url` ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã | Moltbook ãŒã‚ªãƒ¼ãƒŠãƒ¼èªè¨¼ã«äººé–“ã®ã‚¯ãƒªãƒƒã‚¯ã‚’è¦æ±‚ã™ã‚‹ãŸã‚ |

---

## 10. å¢ƒç•Œï¼ˆã‚„ã‚‰ãªã„ã“ã¨ï¼‰

| ã‚„ã‚‰ãªã„ã“ã¨ | ç†ç”± |
|-------------|------|
| æ—¢å­˜ã® `/api/mobile/*` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å¤‰æ›´ã—ãªã„ | å¾Œæ–¹äº’æ›ã€‚å¤ã„iOSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå£Šã‚Œã‚‹ |
| iOSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãªã„ | 1.6.1 ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ + VPS ã®ã¿ |
| æ—¢å­˜ã® TikTok/X ã® GHA ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å¤‰æ›´ã—ãªã„ | Strangler Fig: 1.6.1 ã§ã¯ä¸¦è¡Œç¨¼åƒã€1.7.0 ã§æ®µéšç§»è¡Œ |
| Commander Agent ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å¤‰æ›´ã—ãªã„ | hook_candidates ã®èª­ã¿å–ã‚Šã®ã¿ï¼ˆæ–°ã‚«ãƒ©ãƒ è¿½åŠ ã¯å½±éŸ¿ãªã—ï¼‰ |
| ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® Slack ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«æ¥ç¶šã—ãªã„ | 1.6.1 ã¯ãƒ©ãƒœå®Ÿé¨“ï¼ˆè‡ªåˆ†ã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ã¿ï¼‰ |

### è§¦ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´å†…å®¹ |
|---------|----------|
| `apps/api/prisma/schema.prisma` | AgentPost model è¿½åŠ ã€HookCandidate æ‹¡å¼µ |
| `apps/api/src/api/agent/` | æ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: nudge, wisdom, feedback, content ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |
| `apps/api/src/api/auth/` | agentAuth ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¿½åŠ  |
| `apps/api/src/jobs/syncCrossPlatform.js` | unifiedScore() ã‚’ 5ch ã«æ‹¡å¼µã€refreshBaselines() ã« Moltbook/Slack è¿½åŠ  |

### è§¦ã‚‰ãªã„ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | ç†ç”± |
|---------|------|
| `apps/api/src/api/mobile/*` | æ—¢å­˜ãƒ¢ãƒã‚¤ãƒ«APIã€‚å¾Œæ–¹äº’æ› |
| `apps/api/src/agents/commander.js` | hook_candidates ã‚’èª­ã‚€ã ã‘ã€‚å¤‰æ›´ä¸è¦ |
| `aniccaios/` | iOSã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€‚1.6.1 ã‚¹ã‚³ãƒ¼ãƒ—å¤– |
| `.github/workflows/anicca-daily-post.yml` | æ—¢å­˜TikTokæŠ•ç¨¿ã€‚ä¸¦è¡Œç¨¼åƒ |
| `.github/workflows/anicca-x-post.yml` | æ—¢å­˜XæŠ•ç¨¿ã€‚ä¸¦è¡Œç¨¼åƒ |

## 11. Skill å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| Skill | å®Ÿè¡Œæ–¹å¼ | é–“éš” |
|-------|---------|------|
| moltbook-responder | ãƒãƒ¼ãƒªãƒ³ã‚° | 5åˆ†é–“éš” |
| feedback-fetch | ãƒãƒ¼ãƒªãƒ³ã‚° | 30åˆ†é–“éš” |
| slack-reminder | Cron Skill | æœˆæ›œ12:25ã«ãƒã‚§ãƒƒã‚¯é–‹å§‹ |
| x-poster | Commander é€£æº | Commander Agent ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¾“ã† |

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

| é …ç›® | è¨­å®š |
|------|------|
| ãƒªãƒˆãƒ©ã‚¤ | Exponential backoffï¼ˆåˆå›1åˆ†ã€æœ€å¤§30åˆ†ï¼‰ |
| Circuit breaker | 5å›é€£ç¶šå¤±æ•— â†’ 10åˆ†åœæ­¢ |
| ãƒ­ã‚° | 1-2å›å¤±æ•—: warnã€3å›ä»¥ä¸Š: error |

## 12. å®Ÿè¡Œæ‰‹é †

### ãƒ†ã‚¹ãƒˆ

```bash
cd apps/api && npm test
```

### VPS ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# 1. SSH ã§ VPS ã«æ¥ç¶š
ssh anicca@<vps-ip>

# 2. OpenClaw ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»è¨­å®š
# (OpenClaw ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã«å¾“ã†)

# 3. SOUL.md ã‚’é…ç½®
scp SOUL.md anicca@<vps-ip>:~/openclaw/

# 4. systemd ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
sudo systemctl enable openclaw && sudo systemctl start openclaw
```

### Railway ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# dev â†’ main ãƒãƒ¼ã‚¸ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
# migration ã¯è‡ªå‹•å®Ÿè¡Œï¼ˆPrisma migrate deployï¼‰
```

## 13. TODO

### é«˜å„ªå…ˆ
- [ ] Hetzner VPS ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ ] OpenClaw ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] SOUL.md ä½œæˆ
- [ ] Railway `/api/agent/*` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] moltbook-responder Skill å®Ÿè£…

### ä¸­å„ªå…ˆ
- [ ] slack-reminder Skill å®Ÿè£…
- [ ] feedback-fetch Skill å®Ÿè£…
- [ ] Z-Score 5ãƒãƒ£ãƒãƒ«çµ±åˆ

### ä½å„ªå…ˆ
- [ ] x-poster Skill å®Ÿè£…
- [ ] æ˜‡æ ¼ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | å†…å®¹ |
|------|------|
| 2026-02-02 | åˆç‰ˆä½œæˆï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«å‡ºåŠ›ã‹ã‚‰å¾©å…ƒï¼‰ |
| 2026-02-02 | Blocking issue 6ä»¶ä¿®æ­£: Crisis Protocol, UNIQUEåˆ¶ç´„, Z-Score 5ché‡ã¿, hook_candidatesæ‹¡å¼µ, æ˜‡æ ¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ˜è¨˜, Prisma modelåŒ–, å¢ƒç•Œãƒ»å®Ÿè¡Œæ‰‹é †è¿½åŠ  |
