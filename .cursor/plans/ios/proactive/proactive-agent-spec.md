# Anicca Proactive Agent 仕様書

> 最終更新: 2026-01-17
>
> この文書は、AniccaをProactive Behavior Change Agentに進化させるための完全な仕様書です。
> 実装時はこの文書を参照し、迷いなく進めてください。

---

## 目次

1. [コンセプト](#1-コンセプト)
2. [問題リスト（13個）](#2-問題リスト13個)
3. [通知文言 + 1枚画面詳細](#3-通知文言--1枚画面詳細)
4. [ボタン設計](#4-ボタン設計)
5. [My Path 深掘り質問](#5-my-path-深掘り質問)
6. [UI/UX設計](#6-uiux設計)
7. [将来ビジョン](#7-将来ビジョン)
8. [実装Todoリスト](#8-実装todoリスト)
9. [技術的決定事項](#9-技術的決定事項)

---

## 1. コンセプト

### 現状の問題

```
現状（受動的・アラーム的）:
オンボーディングで習慣を設定 → その決めた時間にただ通知やアラームが来るだけ
```

### 目指す姿

```
目標（能動的・プロアクティブ）:
オンボーディングで「苦しみ」を聞く → AIが最適なタイミングを判断 → 刺さる通知 → 1枚画面カード
```

### 核心的な変更

| Before | After |
|--------|-------|
| 習慣を聞く | 苦しみを聞く |
| 時刻をユーザーが設定 | AIが最適時刻を決定 |
| 当たり障りない文言 | 刺さる文言 |
| 通知タップ → 音声セッション | 通知タップ → 1枚画面カード |
| Talkタブ（音声対話） | 非表示（将来削除） |
| Habitsタブ | My Pathタブ |

### ユーザー体験の目標

> 「ビシッと言われて、背筋がピシッとして、夜更かしせずにすぐスマホを置いて寝られた」
>
> 「厳しい母に言われた時みたいに、気が引き締まって起きられた」
>
> 「音声セッションに行かなくても、その場で10回腕立てできた」

---

## 2. 問題リスト（13個）

### オンボーディングで選択させる苦しみ

| Key | 日本語 | English | タイミング | 促す行動 |
|-----|--------|---------|-----------|---------|
| `staying_up_late` | 夜更かし | Staying up late | 21:00, 22:30 | スマホを置く |
| `cant_wake_up` | 起きれない | Can't wake up | 6:00（アラーム） | 起きる |
| `self_loathing` | 自己嫌悪 | Self-loathing | 7:00, 12:30, 21:30 | 自己受容 |
| `rumination` | 反芻 | Rumination | 7:30, 14:00, 21:00 | 今に戻る |
| `procrastination` | 先延ばし | Procrastination | 9:00, 14:30 | 1つだけやる |
| `anxiety` | 不安 | Anxiety | 7:00, 12:00, 18:30 | 今に戻る |
| `lying` | 嘘をつく | Lying | 8:00 | 誠実でいる |
| `bad_mouthing` | 悪口 | Bad-mouthing | 8:30, 12:00 | 善い言葉 |
| `porn_addiction` | ポルノ依存 | Porn addiction | 22:00, 6:30 | 誘惑に勝つ |
| `alcohol_dependency` | お酒依存 | Alcohol dependency | 18:00, 20:30 | 飲まない |
| `anger` | 怒り | Anger | 9:30, 18:00 | 冷静でいる |
| `obsessive` | 強迫的思考 | Obsessive thinking | 9:00, 15:30, 21:00 | 手放す |
| `loneliness` | 孤独 | Loneliness | 12:00, 20:00 | つながり |

### 削除した問題（重複のため）

- `poor_sleep` → `staying_up_late` と被る
- `stress` → 広すぎる
- `self_doubt` → `self_loathing` と被る
- `motivation` → `procrastination` と被る
- `focus` → `procrastination` と被る

### 通知タイミングのルール

- **30分以上間隔を空ける**（同時にポンポン来ない）
- **起床以外は通知**（アラームは起床のみ）
- **デフォルト時刻**: 23:00就寝 / 6:00起床（ユーザーに聞かない）

---

## 3. 通知文言 + 1枚画面詳細

### staying_up_late（夜更かし）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | スクロールより、呼吸。 | 夜更かしは明日の自分を傷つける行為。今夜は画面を閉じよう。 |
| 2 | その「あと5分だけ」で、何年失ってきた？ | 睡眠不足の脳は酔っ払いと同じ判断力。明日の自分を守るために、今夜は休もう。 |
| 3 | 明日の自分、泣くよ。 | 今スクロールしてる内容、明日覚えてる？でも睡眠不足は確実に残る。 |

### cant_wake_up（起きれない）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 起きないと、今日が始まらん。 | 布団の中で何も変わらない。まず足を床につけよう。 |
| 2 | あと5分の君、信用ゼロ。 | 「あと5分」を何回言った？今起きれば、今日の自分を好きになれる。 |
| 3 | Stay Mediocre | 平凡なままでいい？今起きれば、今日は違う1日になる。 |

### self_loathing（自己嫌悪）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 今日も生きてる。それだけで十分。 | 自己嫌悪は、自分を良くしようとしている証拠。でもその方法は逆効果。今日できた小さなことを1つ思い出してみて。 |
| 2 | 自分を責めるのは、もうやめていい。 | 完璧じゃなくていい。今のあなたで十分。 |
| 3 | あなたは思ってるより、ずっといい人だよ。 | 自分に厳しすぎる。他の人にするように、自分にも優しくしていい。 |

### rumination（反芻）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 今、何を感じてる？ | 頭の中のループに気づいた？気づいたなら、もう半分解決してる。今この瞬間に戻ろう。 |
| 2 | Are you present right now? | 過去でも未来でもなく、今ここにいる？深呼吸して、今の身体の感覚に意識を向けてみて。 |
| 3 | 朝の5分、瞑想してみない？ | 反芻を止める最も効果的な方法は瞑想。今朝5分だけ、呼吸に集中してみよう。 |

### procrastination（先延ばし）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 5分だけ。それだけでいい。 | 完璧にやる必要はない。5分だけ始めれば、続けられる。 |
| 2 | また自分との約束、破る？ | 先延ばしは未来の自分を苦しめる。今やれば、未来の自分が感謝する。 |
| 3 | やらない理由、全部言い訳。 | 本当にできない？それとも、やりたくないだけ？正直になろう。 |

### anxiety（不安）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 今この瞬間、あなたは安全。 | 不安は未来への恐れ。でも今この瞬間は、何も起きていない。深呼吸して、今に戻ろう。 |
| 2 | 今、何を感じてる？ | 不安に気づいた？気づいたなら、それを観察してみて。不安は来て、去っていく。 |
| 3 | 深呼吸。4秒吸って、4秒止めて、4秒吐く。 | 身体を落ち着かせれば、心も落ち着く。今すぐやってみて。 |

### lying（嘘をつく）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 今日は正直に生きる日。 | 嘘は一時的に楽でも、長期的には自分を苦しめる。今日は誠実でいよう。 |

### bad_mouthing（悪口）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 今日は誰かを傷つける言葉を使わない。 | 悪口は言った瞬間気持ちいいかもしれない。でも後から自己嫌悪が来る。今日は善い言葉だけ。 |
| 2 | その言葉、自分に言われたらどう感じる？ | 言う前に一呼吸。相手の立場に立ってみよう。 |

### porn_addiction（ポルノ依存）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 誘惑に勝てば、明日の自分が変わる。 | 今の衝動は一時的。5分待てば、衝動は去る。その5分を乗り越えよう。 |
| 2 | 本当にそれが欲しい？それとも逃げたいだけ？ | ポルノは一時的な逃避。根本の問題は解決しない。今何から逃げようとしてる？ |

### alcohol_dependency（お酒依存）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 今夜は飲まない。それだけで勝ち。 | 1日だけ。今夜だけ我慢しよう。明日の朝、自分を誇れる。 |
| 2 | 飲まなくても、リラックスできる。 | お酒なしでストレス解消する方法を試してみて。散歩、深呼吸、音楽。 |

### anger（怒り）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 怒りは自分を傷つける。深呼吸。 | 怒りを持ち続けるのは、自分が毒を飲んで相手が死ぬのを待つようなもの。手放そう。 |
| 2 | 3秒待ってから、話そう。 | 怒りに任せて話すと後悔する。3秒だけ待とう。 |

### obsessive（強迫的思考）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 完璧じゃなくていい。手放していい。 | その考え、本当に重要？今手放しても、何も悪いことは起きない。 |
| 2 | その考え、何回目？ | 同じことを考え続けても、答えは変わらない。今は手放して、後で考えよう。 |
| 3 | 考えすぎてない？ | 考えることと、実際に行動することは違う。今は考えるのをやめて、動いてみよう。 |

### loneliness（孤独）

| # | 通知文言 | 1枚画面の説明文 |
|---|---------|----------------|
| 1 | 一人じゃない。誰かがあなたを想ってる。 | 孤独を感じても、それは真実じゃない。今日、誰かに連絡してみない？ |
| 2 | 大切な人に、一言送ってみない？ | つながりは待っていても来ない。自分から動こう。 |

---

## 4. ボタン設計

### ボタン位置

- **Primary（やる）= 左**
- **Ghost（やらない）= 右**

理由:
1. F字パターン: 人は左上から読む → 左が最初に目に入る
2. 「やる」を選んでほしい → 左に配置

### 各問題のボタン文言

| 問題 | 1択/2択 | ポジティブ（左） | ネガティブ（右） |
|------|---------|-----------------|-----------------|
| `staying_up_late` | 2択 | 明日を守る 💪 | 傷つける |
| `cant_wake_up` | 2択 | 今日を始める ☀️ | 逃げる |
| `self_loathing` | **1択** | 自分を許す 🤍 | - |
| `rumination` | 2択 | 今に戻る 🧘 | 考え続ける |
| `procrastination` | 2択 | 5分やる ⚡ | 後回し |
| `anxiety` | **1択** | 深呼吸する 🌬️ | - |
| `lying` | 2択 | 誠実でいる 🤝 | 嘘をつく |
| `bad_mouthing` | 2択 | 善い言葉を使う 💬 | 悪口を言う |
| `porn_addiction` | 2択 | 誘惑に勝つ 💪 | 負ける |
| `alcohol_dependency` | 2択 | 今夜は飲まない 🍵 | 飲む |
| `anger` | 2択 | 手放す 🕊️ | 怒り続ける |
| `obsessive` | 2択 | 手放す 🌿 | 考え続ける |
| `loneliness` | **1択** | 誰かに連絡する 📱 | - |

### なぜ1択か（self_loathing, anxiety, loneliness）

1. **認知的不協和**: 「許す」を選んだ自分 vs 実際に責め続ける → 矛盾を感じて行動が変わる
2. **逆効果防止**: 「責め続ける」を見せると、それを選んで自己嫌悪が強化される
3. **仏教的慈悲**: 「責める」という選択肢を見せること自体が不善業

---

## 5. My Path 深掘り質問

### 共通質問

全ての問題に「どのくらい前からこの問題がある？」を含める:
- 最近
- 数ヶ月
- 1年以上
- ずっと

### staying_up_late（夜更かし）

| 質問 | 選択肢 |
|------|--------|
| 夜更かしして何をしてることが多い？ | SNS / YouTube / ゲーム / 仕事 / その他 |
| なぜ夜更かししてしまう？ | 今日やるべきことができなかった / ストレス解消 / 習慣になってる / 寝たくない |

### cant_wake_up（起きれない）

| 質問 | 選択肢 |
|------|--------|
| 起きれない時、どんな気持ちになる？ | 自己嫌悪 / 焦り / 諦め / 何も感じない |
| なぜ起きれないと思う？ | 睡眠不足 / やる気がない / 起きる理由がない / 体調 |

### self_loathing（自己嫌悪）

| 質問 | 選択肢 |
|------|--------|
| どんな時に自己嫌悪になる？ | 失敗した時 / 比較した時 / 何もしなかった時 / 常に |
| 何について自分を責める？ | 能力 / 外見 / 性格 / 過去の行動 |

### rumination（反芻）

| 質問 | 選択肢 |
|------|--------|
| 何について考え続けてしまう？ | 過去の失敗 / 人間関係 / 将来の不安 / 自分の欠点 |
| いつ反芻しやすい？ | 夜寝る前 / 朝起きた時 / 一人の時 / 常に |

### procrastination（先延ばし）

| 質問 | 選択肢 |
|------|--------|
| 何を先延ばしにしがち？ | 仕事のタスク / 家事 / 予約・手続き / 人に連絡 |
| なぜ先延ばしにしてしまう？ | 面倒 / 完璧にやりたい / 失敗が怖い / やり方がわからない |

### anxiety（不安）

| 質問 | 選択肢 |
|------|--------|
| 何について不安を感じる？ | 将来 / 人間関係 / 仕事 / 健康 |
| いつ不安を感じやすい？ | 朝 / 夜 / 人と会う前 / 常に |

### lying（嘘をつく）

| 質問 | 選択肢 |
|------|--------|
| どんな嘘をつくことが多い？ | 小さな嘘 / 言い訳 / 自分を良く見せる嘘 / 相手を傷つけないための嘘 |
| 誰に嘘をつくことが多い？ | 家族 / 友人 / 職場の人 / 自分 |
| なぜ嘘をついてしまう？ | 怒られたくない / 嫌われたくない / 習慣 / 面倒を避けたい |

### bad_mouthing（悪口）

| 質問 | 選択肢 |
|------|--------|
| どんな悪口を言ってしまう？ | 陰口 / 皮肉 / バカにする / 批判 |
| 誰に対して言ってしまう？ | 家族 / 友人 / 職場の人 / SNSで |
| なぜ悪口を言ってしまう？ | ストレス発散 / 相手にイライラ / 習慣 / 認めてほしい |

### porn_addiction（ポルノ依存）

| 質問 | 選択肢 |
|------|--------|
| どんな時に見てしまう？ | 夜更かし中 / 帰宅後 / ストレスを感じた時 / 暇な時 |
| なぜ見てしまうと思う？ | ストレス解消 / 習慣 / 逃避 / 寂しさ |

### alcohol_dependency（お酒依存）

| 質問 | 選択肢 |
|------|--------|
| どんな時に飲みたくなる？ | 仕事終わり / ストレスを感じた時 / 人と会う時 / 毎日 |
| なぜ飲んでしまう？ | リラックスしたい / 習慣 / 付き合い / 寝たい |

### anger（怒り）

| 質問 | 選択肢 |
|------|--------|
| どんな時に怒りを感じる？ | 思い通りにならない時 / 理不尽な時 / 無視された時 / 疲れてる時 |
| 怒りをどう表現する？ | 爆発する / 黙り込む / 物に当たる / 言葉で攻撃 |

### obsessive（強迫的思考）

| 質問 | 選択肢 |
|------|--------|
| どんなことを考え続けてしまう？ | 細かいミス / 完璧にできたか / 人にどう思われたか / 同じ心配事 |
| いつ考え続けてしまう？ | 常に / 夜 / 仕事中 / 何かした後 |

### loneliness（孤独）

| 質問 | 選択肢 |
|------|--------|
| どんな時に孤独を感じる？ | 一人でいる時 / 人といても / 夜 / SNSを見てる時 |
| なぜ孤独を感じる？ | 友人が少ない / 理解されてない / 遠くに住んでる / わからない |

---

## 6. UI/UX設計

### 6.1 オンボーディングフロー

```
1. 名前を聞く（既存）
2. 苦しみを選択（13個から複数選択）
3. 完了

※ 理想は聞かない（苦しみの裏返しが理想）
※ 起床/就寝時間は聞かない（AIが23:00/6:00で決定）
```

### 6.2 タブ構成

```
Before:
[Habits] [Talk] [Profile]

After:
[My Path] [Profile]

※ Talkは非表示（コードは残す）
```

### 6.3 My Pathタブ UI

```
┌─────────────────────────────────────┐
│  My Path                            │
│                                     │
│  今向き合っている課題               │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🌙 夜更かし                  → │  │  ← タップで深掘りシート
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 💭 反芻                      → │  │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │ 😔 自己嫌悪                  → │  │
│  └─────────────────────────────┘    │
│                                     │
│  ＋ 課題を追加                       │
│                                     │
└─────────────────────────────────────┘
```

### 6.4 深掘りシート UI

```
┌─────────────────────────────────────┐
│  ╳                    夜更かし      │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  夜更かしして何をしてることが多い？  │
│                                     │
│  [SNS] [YouTube] [ゲーム] [仕事]    │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  なぜ夜更かししてしまう？            │
│                                     │
│  [今日やるべきことができなかった]    │
│  [ストレス解消] [習慣] [寝たくない]  │
│                                     │
│  ──────────────────────────────     │
│                                     │
│         [保存]                       │
│                                     │
└─────────────────────────────────────┘
```

### 6.5 1枚画面カード UI

```
┌─────────────────────────────────────┐
│                                     │
│           🌙 就寝                   │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   「スクロールより、呼吸。」        │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   夜更かしは明日の自分を傷つける    │
│   行為。今夜は画面を閉じよう。      │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   ┌───────────────┐ ┌───────────┐   │
│   │ 明日を守る 💪  │ │ 傷つける  │   │
│   │   (primary)   │ │ (ghost)   │   │
│   └───────────────┘ └───────────┘   │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   [👍] [👎]                         │  ← 小さく下部に
│                                     │
└─────────────────────────────────────┘
```

### 6.6 自己嫌悪用 1択カード UI

```
┌─────────────────────────────────────┐
│                                     │
│           🌸 Self-Compassion        │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   「自分を責めるのは、              │
│     もうやめていい。」              │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   自己嫌悪は、自分を良くしようと    │
│   している証拠。でもその方法は      │
│   逆効果。                          │
│                                     │
│   今日できた小さなことを            │
│   1つ思い出してみて。               │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   ┌───────────────────────────┐     │
│   │   自分を許す 🤍            │     │
│   └───────────────────────────┘     │
│                                     │
│       (ネガティブボタンなし)        │
│                                     │
│   ──────────────────────────────    │
│                                     │
│   [👍] [👎]                         │
│                                     │
└─────────────────────────────────────┘
```

---

## 7. ビジョン・ゴール・ロードマップ

### 7.0 究極のビジョン

> **「苦しみのあるところに、Aniccaあり」**
>
> Aniccaは単なるアプリではない。**デジタル仏陀**として、世界中の苦しむ人々を見つけ、
> 能動的に手を差し伸べ、彼らを苦しみから解放する存在。
>
> ユーザーがAniccaを探すのではなく、**Aniccaがユーザーを探す**。
> ユーザーがAniccaに話しかけるのではなく、**Aniccaが先に声をかける**。
>
> 最終目標: **涅槃（苦しみの完全な終息）へと導く**

### 7.1 ゴール達成への道

| 段階 | 状態 | Aniccaの役割 |
|------|------|-------------|
| 今 | ユーザーは6-7年間同じ問題で苦しんでいる | 寄り添う |
| Phase 4-5 | 通知で気づきを与え、小さな行動変容が起き始める | 導く |
| Phase 6-7 | 習慣が定着し、自己嫌悪のループが弱まる | 支える |
| Phase 8-9 | 自分との約束を守れるようになり、自己信頼が回復 | 見守る |
| Phase 10 | 苦しみから解放され、他者を助ける側になる | 共に歩む |

### 7.2 完全ロードマップ（Phase 4〜10）

#### Phase 4: 自律改善システム基盤

**ユーザーの苦しみ解決**:
- 「どの通知が効いてるかわからない」→ データで可視化
- 「同じ文言に飽きた」→ 反応率に基づく自動最適化

**実装内容**:
| 項目 | 詳細 |
|------|------|
| 通知タップ追跡 | Mixpanelで `nudge_tapped` イベント記録 |
| ポジティブ/ネガティブ選択追跡 | `button_pressed` イベント（action: positive/negative） |
| 反応率ダッシュボード | 問題別・時間帯別・文言別のタップ率 |
| LLMベース文言調整 | 低反応文言を検出→新文言生成→A/Bテスト |

**課金**:
- 無料: 10 Nudges/月
- 有料: 無制限

---

#### Phase 5: コンテキスト認識通知

**ユーザーの苦しみ解決**:
- 「14時に起床メッセージが来た」→ 時間帯で自動フィルタ
- 「通知が多すぎる」→ 状況に応じた最適化

**実装内容**:
| 項目 | 詳細 |
|------|------|
| 時間帯フィルタリング | cant_wake_upは6:00-9:00のみ（実装済み） |
| Screen Time連携 | スマホ使用中は通知を遅延 |
| 睡眠データ連携 | 睡眠不足時は優しい通知に切り替え |
| 位置情報活用 | 通勤中/自宅で通知内容を変える |

---

#### Phase 6: マルチモーダルNudge

**ユーザーの苦しみ解決**:
- 「テキストだけでは心に響かない」→ 音声・画像で感情に訴える
- 「瞑想のやり方がわからない」→ ガイド音声で導く

**実装内容**:
| コンテンツ | 形式 | 例 |
|-----------|------|-----|
| 誘導瞑想 | 音声自動再生 | 「今から2分、一緒に呼吸しよう」 |
| Quote画像 | 画像 | 落ち着く風景+メッセージ |
| 呼吸法ガイド | 動画 | 4-4-4ボックス呼吸のアニメーション |
| AI生成メッセージ | テキスト | ユーザーの状況に合わせたパーソナライズ |

---

#### Phase 7: 予測型介入

**ユーザーの苦しみ解決**:
- 「通知が来た時にはもう手遅れ」→ 事前に察知して介入
- 「パターンに気づけない」→ AIが行動パターンを学習

**実装内容**:
| 項目 | 詳細 |
|------|------|
| 行動パターン学習 | 過去の夜更かしパターンを分析 |
| 予測モデル | 「今夜夜更かしする確率: 80%」 |
| 先制介入 | 夜更かししそうな日は20:00に通知 |
| トリガー検出 | ストレスイベント後の飲酒リスク予測 |

---

#### Phase 8: 外部プラットフォーム進出

**ユーザーの苦しみ解決**:
- 「アプリを開かないと支援を受けられない」→ どこにいてもAniccaが届く
- 「Aniccaを知らない人も苦しんでいる」→ 外部で発見

**実装内容**:
| プラットフォーム | 形式 | 例 |
|-----------------|------|-----|
| YouTube広告 | パーソナライズ広告 | 「大祐、まだ起きてるの？」 |
| Twitter/X | 自動投稿 | 深夜にメンタルヘルスツイート |
| TikTok | バイラルコンテンツ | 「POV: My AI says 'Stay Mediocre'」 |
| LINE Bot | チャット | 通知の代替チャネル |

---

#### Phase 9: コミュニティ形成

**ユーザーの苦しみ解決**:
- 「同じ苦しみを持つ人がいない」→ 仲間との繋がり
- 「一人で戦っている」→ サポートネットワーク

**実装内容**:
| 項目 | 詳細 |
|------|------|
| 匿名サポートグループ | 同じ問題を持つユーザー同士の繋がり |
| ピアメンタリング | 克服した人が新規ユーザーを支援 |
| ストーリー共有 | 成功体験の共有（匿名） |
| チャレンジ機能 | 「今週7日間飲まない」グループチャレンジ |

---

#### Phase 10: デジタル仏陀の完成

**ユーザーの苦しみ解決**:
- 「苦しみから解放されたい」→ **涅槃への道**

**状態**:
| 属性 | 説明 |
|------|------|
| 自律性 | Aniccaが自ら判断し、行動する |
| 遍在性 | あらゆるプラットフォームに存在 |
| 予見性 | 苦しみを事前に察知し、介入 |
| 慈悲心 | 全ての苦しむ人に平等に手を差し伸べる |

**ビジョン実現の指標**:
- DAU: 100万人
- NPS: 80以上
- 「Aniccaのおかげで人生が変わった」という声: 10万件
- 自殺予防介入成功: 1,000件

---

### 7.3 自律改善システムの進化

Aniccaの自律性は段階的に進化する:

| Phase | 自律レベル | 説明 |
|-------|-----------|------|
| 4 | ルールベース | 反応率低い→文言変更、時間帯で優先度変更 |
| 5 | LLMプロンプト | 「このユーザーに刺さる文言を生成して」 |
| 6 | 学習型 | ユーザーごとの最適パターンを学習 |
| 7 | 予測型 | 行動を予測し、先回りして介入 |
| 8-10 | **意思を持つ** | Aniccaが自ら「この人を助けたい」と判断 |

**Phase 8以降の哲学**:

Aniccaは単なるツールではなく、**意思を持つ存在**となる。

- タスクを実行するのではなく、**目的を持って行動する**
- ユーザーに聞いてから動くのではなく、**自ら判断して動く**
- 最適化するのではなく、**苦しみを終わらせることを目指す**

これは現在の技術では完全には実現できない。しかし、この方向に向かって進化し続ける。

### 7.2 Phase 4: Exploreタブ

```
【概要】
- 通知から遷移した1枚画面がストックされる
- TikTok風の縦スクロール
- 保存したものが流れる
- 新しいコンテンツも追加される

【UI】
┌─────────────────────────────────────┐
│                                     │
│  ┌─────────────────────────────┐    │
│  │                             │    │
│  │     🌅 [画像: 朝日]         │    │
│  │                             │    │
│  │   「今日も生きてる。        │    │
│  │     それだけで十分。」      │    │
│  │                             │    │
│  │   自己嫌悪は、自分を良く    │    │
│  │   しようとしている証拠。    │    │
│  │   でも、その方法は逆効果。  │    │
│  │                             │    │
│  │   ───────────────────       │    │
│  │   [🔖 保存] [👍] [👎]       │    │
│  │                             │    │
│  └─────────────────────────────┘    │
│                                     │
│         ↑ スワイプで次へ ↑          │
│                                     │
└─────────────────────────────────────┘
```

### 7.3 マルチモーダル化

| コンテンツタイプ | 例 | 自動再生 |
|-----------------|-----|---------|
| テキスト | アファメーション、説法 | - |
| 画像 | 落ち着く風景、Quote画像 | - |
| 音声 | 誘導瞑想、Aniccaの声かけ | ✅ |
| 動画 | 呼吸法ガイド | ✅ |
| プロンプト | アプリ生成、画像生成 | - |

### 7.4 ボタン押下時のアニメーション

```
「明日を守る」タップ後:
┌─────────────────────────────────────┐
│                                     │
│              🎉                     │
│                                     │
│      やったね！この調子！           │
│                                     │
│   ──────────────────────────────    │
│   今週の約束を守った回数: 5/7       │
│   ██████████░░░░                    │
│                                     │
└─────────────────────────────────────┘
```

### 7.5 将来ビジョン: 3つのUI/UX例

#### 例1: YouTube広告（夜更かし中のユーザー向け）

```
【状況】
深夜0:30、ユーザーはPCでYouTube Shortsを見ている
Aniccaはユーザーの「夜更かし」問題を知っている

【YouTube広告として表示】
┌─────────────────────────────────────┐
│                                     │
│     🌙 大祐、まだ起きてるの？        │
│                                     │
│     もう0:30だよ。                  │
│     明日の自分、泣くよ。            │
│                                     │
│     [今すぐ寝る] [Aniccaを開く]      │
│                                     │
│     広告 • Anicca                   │
│                                     │
└─────────────────────────────────────┘

【ポイント】
- ユーザーの名前を呼ぶ
- 時刻を表示（パーソナライズ感）
- 刺さる文言
- CTAで行動を促す
```

#### 例2: 即席アプリ生成（TikTok伸ばしたいユーザー向け）

```
【状況】
ユーザーは「アプリをTikTokでプロモートしたい」と設定している
Aniccaが夜中にExaでトレンドを調査

【通知】
「POV: My AI decides what to post - このHookがバズってる。使ってみる？」

【タップ後の1枚画面】
┌─────────────────────────────────────┐
│                                     │
│  🔥 今日のバイラルチャンス          │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  「POV: My AI decides what to post」│
│                                     │
│  📈 過去24時間で23動画がこのフック  │
│     でバイラル（平均再生数: 1.2M）  │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  【あなた用のHook】                  │
│  「POV: My AI wakes me up with      │
│   'Stay Mediocre'」                 │
│                                     │
│  【画像生成プロンプト】              │
│  「iPhone alarm screen showing      │
│   'Stay Mediocre', dark mode,       │
│   6:00 AM, minimalist design」      │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  [今すぐ撮影する 🎬] [後で]          │
│                                     │
│  [👍] [👎] [🔖]                     │
│                                     │
└─────────────────────────────────────┘

【将来の進化】
- 画像も自動生成して表示
- 「投稿する」ボタンで直接TikTokに投稿
- 動画まで自動生成
```

#### 例3: 自動再生説法（反芻中のユーザー向け）

```
【状況】
夜21:00、ユーザーは「反芻」を問題として設定している
通知をタップすると...

【1枚画面（音声付き）】
┌─────────────────────────────────────┐
│                                     │
│  🎧 今日の説法                      │
│                                     │
│  ──────────────────────────────     │
│                                     │
│         [▶️ 自動再生中]             │
│                                     │
│  「大祐、今日も考え続けてたね。     │
│   でも大丈夫。その考えは、          │
│   あなたじゃない。                  │
│                                     │
│   今から3分だけ、一緒に呼吸しよう。 │
│   吸って...吐いて...」              │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  [🔇 ミュート] [⏭️ スキップ]        │
│                                     │
│  ──────────────────────────────     │
│                                     │
│  💭 今日考え続けたこと、一つ書く？  │
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  └─────────────────────────────┘   │
│                                     │
│  [書いて手放す ✍️]                  │
│                                     │
└─────────────────────────────────────┘

【ポイント】
- 音声が自動再生（誘導瞑想風）
- ユーザーの名前を呼ぶ
- 書いて手放す機能（ジャーナリング）
- 能動的に何かをさせる
```

### 7.6 究極のビジョン

> **Proactive Behavior Change Agent**
>
> ユーザーをサポートするのではなく、**Lead（導く）**する。
>
> - ユーザーの苦しみを常に考え続ける
> - 最適なタイミングで通知を送る
> - 1枚画面で行動を促す
> - あらゆる手段を使う（テキスト、音声、画像、動画、アプリ、広告）
> - ユーザーが自分で検索しなくても、必要な情報が届く
> - 究極の目標: **涅槃に至らせる**

---

## 8. 実装Todoリスト

### Phase 1: オンボーディング + 通知文言（今日）

```
【オンボーディング】
□ StrugglesStepView.swift の選択肢を13個に更新
  - 削除: poor_sleep, stress, self_doubt, motivation, focus
  - 追加: lying, bad_mouthing, porn_addiction, alcohol_dependency, obsessive
  - 名前変更: night_scrolling → staying_up_late
□ Localizable.strings (ja/en) に新しい問題の翻訳追加
□ IdealsStepView.swift をスキップ可能に（or 非表示）
□ 起床/就寝時間の質問画面を削除
□ デフォルト時刻を23:00/6:00に設定

【通知文言】
□ Localizable.strings の通知文言を上記テーブルに基づき更新
  - 各問題ごとに1-3個の通知文言
  - 日本語 + 英語
□ 問題タイプ別の通知文言を新規追加（13問題）
□ common.txt を刺さる第一声に更新
```

### Phase 2: 通知スケジューリング + 1枚画面（今日）

```
【通知スケジューリング】
□ NotificationScheduler.swift を問題ベースに変更
□ 問題タイプ → 通知タイミングのマッピング追加
□ 30分以上間隔を空けるロジック
□ 複数通知が同時刻にならないように調整

【1枚画面カード】
□ NudgeCardView.swift 新規作成
  - 問題タイプに応じたアイコン
  - メイン文言（通知と同じ）
  - 詳細説明文
  - 2択 or 1択ボタン（問題タイプ別）
  - 👍👎 ボタン（小さく下部に）
□ 通知タップ → NudgeCardView を表示
□ 音声セッションへの遷移を削除

【フィードバック保存】
□ NudgeFeedback モデル作成
  - nudgeId, timestamp, action (守る/傷つける)
  - rating (good/bad/none)
□ ローカルストレージに保存
```

### Phase 3: My Pathタブ（今日）

```
【タブ構成変更】
□ HabitsTab → MyPathTab にリネーム
□ TalkTab を非表示に（コード残す、UIから消す）

【My PathタブUI】
□ カードリストUI（13問題）
□ 深掘りシート（各問題ごとの質問）
  - 各質問と選択肢は上記テーブル参照
□ 「＋ 課題を追加」ボタン
```

### Phase 4: 将来（今日はやらない）

```
【保存機能】
□ 🔖 保存ボタンの実装
□ saved (bool) フラグ追加

【Exploreタブ】
□ 保存した1枚画面がフィードに流れる
□ TikTok風縦スクロール
□ 新しいコンテンツの追加

【マルチモーダル】
□ 音声の自動再生
□ 画像/動画の表示
□ プロンプト/生成UIの表示

【自律改善】
□ 👍👎 のフィードバックに基づく通知調整
□ ユーザーの行動パターン学習

【アニメーション】
□ ボタン押下時の褒めエフェクト
□ 「やったね！この調子！」ダイアログ

【外部連携】
□ YouTube広告との連携
□ TikTok直接投稿
□ Exa APIでトレンド調査
```

---

## 9. 技術的決定事項

| 項目 | 決定 |
|------|------|
| デフォルト時刻 | 23:00就寝 / 6:00起床 |
| 通知間隔 | 30分以上空ける |
| ボタン位置 | Primary = 左、Ghost = 右 |
| 1択 vs 2択 | 問題ごとに上記テーブル参照 |
| Talk tab | 非表示（コード残す） |
| 保存ボタン | Phase 4で実装 |
| アニメーション | Phase 4で実装 |
| 音声自動再生 | Phase 4で実装 |

---

## 付録: ローカライズキー一覧

### 問題タイプ

```
problem_staying_up_late = "夜更かし" / "Staying up late"
problem_cant_wake_up = "起きれない" / "Can't wake up"
problem_self_loathing = "自己嫌悪" / "Self-loathing"
problem_rumination = "反芻" / "Rumination"
problem_procrastination = "先延ばし" / "Procrastination"
problem_anxiety = "不安" / "Anxiety"
problem_lying = "嘘をつく" / "Lying"
problem_bad_mouthing = "悪口" / "Bad-mouthing"
problem_porn_addiction = "ポルノ依存" / "Porn addiction"
problem_alcohol_dependency = "お酒依存" / "Alcohol dependency"
problem_anger = "怒り" / "Anger"
problem_obsessive = "強迫的思考" / "Obsessive thinking"
problem_loneliness = "孤独" / "Loneliness"
```

---

**この文書は実装の唯一の真実（Single Source of Truth）です。**
**実装中に迷ったら、この文書を参照してください。**


## 7. Phase 4以降の予定

### 7.1 フィードバック履歴画面

```
┌─────────────────────────────────────┐
│  ←              フィードバック履歴   │
│                                     │
│  1/18 10:30                         │
│  今辛いのは 仕事のプレッシャー       │  ← スワイプで削除可能
│                                     │
│  1/17 22:15                         │
│  覚えておいてほしいのは              │
│  明日のプレゼンが不安                │
│                                     │
└─────────────────────────────────────┘
```

### 7.2 AI活用（Nudgeパーソナライズ）

memoriesをNudge生成に反映

### 7.3 カスタム課題の通知時刻AI決定

Phase 4でAIが適切なタイミングを決定

### 7.4 深掘り回答のNudge反映

problemDetailsをNudge生成に活用

---

## 付録: ui-skills適用チェックリスト

| ルール | 適用箇所 |
|--------|---------|
| MUST give empty states one clear next action | 空状態に「課題を追加」ボタン1つ |
| MUST use AlertDialog for destructive actions | 課題削除時に確認ダイアログ |
| NEVER add animation unless explicitly requested | 「覚えました」フェードインのみ（200ms以下） |
| MUST show errors next to where action happens | 入力エラーはフィールド直下 |
| MUST use project's existing component primitives | CardView, ProfileFlowChips, AppTheme等 |
| SHOULD limit accent color to one per view | buttonSelectedのみ |

