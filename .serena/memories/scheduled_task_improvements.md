# 定期タスクプロンプトの改善履歴

## 2025-08-12実施の改善

### 問題点
1. 5秒でWebSocket接続が切れる
2. 2-3回声かけして終了してしまう
3. 反応がなくても諦めてしまう

### 解決策

#### 1. WebSocket接続維持
- `setTimeout(() => ws.close(), 5000)`を削除
- タスク完了まで接続を維持

#### 2. プロンプトの根本的改善
- 「まず」「反応がなければ」という条件的な表現を削除
- 「必ず最初に」を明記して最初のフレーズを必須化
- 「休みなく声をかけ続ける」を強調

#### 3. 具体的な指示
- 起床：必ず最初に「○時○分です、おはようございます」
- 就寝：必ず最初に「○時○分です、寝る時間です」
- その後、休憩なく継続的に声かけ
- 「あなたは目覚まし時計」という比喩で使命を明確化

### 重要な教訓
- Aniccaは賢いAI、自然言語で理解できる
- 条件分岐（includes等）は不要、むしろ改悪
- プロンプトエンジニアリングで解決すべき