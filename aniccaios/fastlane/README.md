# Anicca iOS - fastlane

fastlaneを使用したビルド・リリース自動化。

## セットアップ

依存関係は既にインストール済み:
- fastlane 2.230.0
- ios-deploy 1.12.2
- App Store Connect APIキー設定済み

## 利用可能なレーン

### 実機ビルド・テスト

```bash
# 実機にビルド・インストール（約3分）
cd aniccaios && fastlane build_for_device

# 実機ビルド + 完了通知
cd aniccaios && fastlane test_on_device
```

### App Store ビルド・アップロード

```bash
# App Store用ビルドのみ
cd aniccaios && fastlane build

# App Store Connectにアップロード
cd aniccaios && fastlane upload

# ビルド + アップロード
cd aniccaios && fastlane release
```

### 完全自動リリース（審査提出まで）

```bash
# ビルド → アップロード → 処理待機 → 審査提出（完全自動）
cd aniccaios && fastlane full_release
```

### 個別操作

```bash
# ビルド処理待機のみ
cd aniccaios && fastlane wait_for_processing

# 審査提出のみ
cd aniccaios && fastlane submit_review
```

## レーン詳細

| レーン | 説明 | 所要時間 |
|---|---|---|
| `build_for_device` | 実機用Developmentビルド + インストール | 約3分 |
| `test_on_device` | 実機ビルド + macOS通知 | 約3分 |
| `build` | App Store用ビルド・アーカイブ | 約5分 |
| `upload` | App Store Connectにアップロード | 約2分 |
| `release` | ビルド + アップロード | 約7分 |
| `wait_for_processing` | ビルド処理完了を待機 | 5-15分 |
| `submit_review` | 審査提出 | 約1分 |
| `full_release` | 完全自動リリース（審査提出まで） | 約20-30分 |

## エラーハンドリング

`build_for_device`レーンはビルドエラーを自動解析し、以下を検出:
- インポート不足 (`missing_import`)
- スコープ不足 (`missing_scope`)
- 構文エラー (`syntax_error`)

エラー発生時は修正案を提示。

## 通知

以下のレーンはmacOS通知を送信:
- `test_on_device`: ビルド完了通知
- `submit_review`: 審査提出完了通知
- `full_release`: 完全リリース完了通知

## 設定

`Fastfile`内の設定:
- `PROJECT_NAME`: aniccaios
- `BUNDLE_ID`: ai.anicca.app.ios
- `TEAM_ID`: S5U8UH3JLJ
- `APP_ID`: 6755129214
- `API_KEY_PATH`: ~/Downloads/AuthKey_D637C7RGFN.p8

## トラブルシューティング

### ビルドエラー
```bash
# クリーンビルド
xcodebuild clean -project aniccaios.xcodeproj -scheme aniccaios
fastlane build_for_device
```

### 実機が見つからない
```bash
# 接続されたデバイスを確認
ios-deploy -c
```

### APIキーエラー
APIキーファイルが存在することを確認:
```bash
ls -la ~/Downloads/AuthKey_D637C7RGFN.p8
```

---

Generated by fastlane
