# 方法

## 参加者

本研究では、2021〜2023年度に収集された、50名の健常成人（男性25名、女性25名）を対象とした生体データを用いた。すべての参加者は研究への参加に同意し、株式会社国際電気通信基礎技術研究所（ATR）倫理審査委員会による承認を得ている。参加者には実験協力の謝礼が支払われ、取得されたデータは匿名化された上で解析に用いられた。

## 課題とラベリング方法

本研究では、マインドワンダリング（MW）を引き起こす課題としてGradual Onset Continuous Performance Task（gradCPT）を使用した [@Rosenberg2013]。gradCPTは持続的注意の測定に特化した課題であり、連続呈示される画像に対して、特定の画像（山の画像）には反応を控え、それ以外（街の画像）にはキーを押下するGo/No-Go課題である。本課題の特徴は、刺激画像が徐々にフェードイン・フェードアウトすることで、明確な刺激オンセットを排除し、持続的な注意維持を要求する点にある。先行研究では、gradCPTが注意の揺らぎやマインドワンダリングを誘発しやすいことが報告されており、課題パフォーマンス（反応時間の変動、エラー率）とMW状態との関連性が実証されている [@Esterman2013]。

本課題はgradCPT [@Rosenberg2013] に基づき、12分間の課題中、刺激は1200msごとに連続的に切り替わる。自己報告プローブは、参加者の内的注意状態を評価するための質問画面であり、課題中にランダムに提示された。被験者は直前の注意の状態を課題関与/非関与×感覚志向/思考志向の2軸で報告した [@Rosenberg2013]。第一軸（x軸）は「課題関与度」を表し、左端（-1）が「完全に課題から離れた思考」、右端（+1）が「完全に課題に集中」を意味する。第二軸（y軸）は「思考の志向性」を表し、下端（-1）が「感覚的・知覚的経験に焦点」、上端（+1）が「抽象的思考や内的対話に焦点」を意味する。各参加者に対して、実験全体で25回のプローブが提示された。この報告から得られるx軸（課題関与度）とy軸（感覚志向度）の座標を用いて、ユークリッド距離を算出し、MWの強度を連続変数（0〜1）として定量化した。

## データ取得と前処理

データ取得は以下の3つのモダリティで行われた：

- **EEG**（耳内装着型：Auris In-Ear EEG、サンプリングレート：250 Hz）
- **瞳孔径**（Pupil Core）
- **課題反応**（キー入力および反応時間）

### EEGデータの前処理

EEG信号は0.5〜40 Hzのバンドパスフィルタおよび50 Hzノッチフィルタで前処理された後、プローブイベントを基準として、その3.9秒前から0秒（プローブ提示時点）までの区間をエポックとして抽出した。計算負荷軽減のためダウンサンプリングされ、DCオフセット除去のためベースライン補正が適用された。

EEGは左手首をグランド電極、右耳内をリファレンス電極として、左耳内から記録された [@Looney2012; @Mikkelsen2015]。

### 瞳孔データの前処理

瞳孔径はPupil Core（Pupil Labs社製）を用いて測定された。Pupil Coreは赤外線カメラを用いた眼球追跡システムであり、2D楕円フィッティングアルゴリズムによって瞳孔径を算出する [@Kassner2014]。具体的には、検出された瞳孔輪郭に対して楕円を当てはめ、その長軸と短軸から瞳孔面積を推定し、等価円直径として瞳孔径（単位：ピクセルまたはmm）を出力する。さらに、Pupil Coreはpye3dと呼ばれる3D眼球モデルも実装しており、これは眼球運動学と光学を捉えた数学的3D眼球モデルに基づいている [@Swirski2013]。この3Dモデルは視線角度による瞳孔の遠近法歪みを補正し、より正確な瞳孔サイズ推定を可能にする。本研究では、両モデルから得られた瞳孔径データを特徴量として使用した。

瞳孔データはタイムスタンプに基づいてEEGと同期された。信頼度（confidence）は、Pupil Coreが瞳孔輪郭検出時に自動算出する指標であり、楕円フィッティングの精度を0〜1のスケールで表す。本研究では信頼度が0.9未満のデータを低品質とみなし除外した。リサンプリング後も残存するNaN値を除外し、最終的にプローブイベントに基づきエポック分割を行った。

## 特徴量抽出

### EEG特徴量

EEGデータからは周波数帯域別のパワー（Theta: 4–8Hz、Alpha: 8–12Hz、Beta: 13–30Hz）を算出した。Thetaパワーは内的注意やマインドワンダリングに関係し [@RodriguezLarios2020; @vanSon2019]、Alphaパワーは外的課題からの乖離を示す指標とされる [@Ceh2020; @Compton2019]。また、Betaパワーは認知的集中に関連し、マインドワンダリング中には減少する傾向がある。加えて、EEG時系列の構造的特性を捉えるために、Embedding Matrixから算出された統計量（平均、標準偏差、最大値、最小値）を用いた。Embedding Matrixとは、時系列信号から遅延座標を用いて構築される行列であり、信号の動的な構造や位相空間の特性を表現する手法である [@Hazarika2024]。

本研究における単一チャンネルEEGの前処理において、Embedded Artifact Subspace Reconstruction（E-ASR）手法を採用した。従来のArtifact Subspace Reconstruction（ASR）アルゴリズムは、主成分分析を用いた適応的空間フィルタリング手法として多チャンネルEEGにおいて高い性能を示してきたが、単一チャンネルデータには適用できないという本質的な限界を有していた。この問題を解決するため、@Hazarika2024 によって提案されたE-ASR手法は、動的埋め込み（dynamical embedding）の概念を導入し、単一チャンネルEEG信号から遅延ベクトルを用いて疑似多チャンネル行列を構築することで、ASRアルゴリズムの適用を可能にした。

### 瞳孔径特徴量

瞳孔径データからは、基本統計量（平均、標準偏差、最大、最小）に加えて、時間変化の傾き（1次導関数）を算出した。さらに、注視（fixation）とサッカード（saccade）に関する情報も特徴量として抽出した。一般に、マインドワンダリング中は注視時間が延長し、視覚探索活動が低下することが知られており [@Benedek2017; @Faber2020]、これらの特徴量はMW状態を反映する重要な指標となる。

### 行動応答特徴量

gradCPT中のキー反応からは、RTCV（Response Time Coefficient of Variability）を算出した。RTCVは反応時間の標準偏差を平均で割ったものであり、注意の揺らぎやマインドワンダリングに伴う不安定な反応を示す指標とされる [@Esterman2013; @Rosenberg2013]。

## ラベリングとスコア化

各ブロックの終了時に取得された自己報告プローブのx/y座標に基づき、原点（課題に関与しており、感覚にも向いている状態）からのユークリッド距離をMWスコアとした。このスコアは、マインドワンダリングの強度を連続的に表すものであり、以降のモデリングにおいて回帰問題として扱った。

## モデリングと検証

得られた各エポックに対して、上述のEEG、瞳孔径、行動特徴量を入力とし、MWスコアを出力とする回帰モデルを構築した。モデルにはSupport Vector Regression（SVR）を使用した。ハイパーパラメータの探索には、ハイパーパラメータ最適化ライブラリOptunaによるベイズ最適化を用いて、Tree-structured Parzen Estimator（TPE）に基づくベイズ最適化を行った [@Akiba2019]。具体的には、Leave-One-Subject-Out交差検証における平均二乗誤差（MSE）を最小化することを目的として、SVRのC（0.01〜100、対数スケール）、epsilon（0.001〜2）、kernel（linear/poly/rbf）に加えて、各特徴量の使用有無をカテゴリカルな探索変数として定義し、合計10試行の探索を行った。

本研究では、Nested cross-validation（入れ子型交差検証）を採用した。外側のCV（outer CV）にはLeave-One-Subject-Out Cross Validation（LOSO）を用い、各被験者をテスト群として汎化性能を評価した。内側のCV（inner CV）では、残りの被験者のデータを用いてOptunaによるベイズ最適化（10試行）を行い、SVRのハイパーパラメータ（C, epsilon, kernel）および特徴量選択を最適化した。また、LassoCVによる特徴量選択では5分割の内側CVにより最適な正則化パラメータλを決定した。

特徴量選択には、LassoCV（Least Absolute Shrinkage and Selection Operator with Cross-Validation）を用いた。LassoCVは5分割交差検証により最適な正則化パラメータλを自動決定する。scikit-learnのLassoCVでは、入力データに基づいて探索するλの範囲が自動的に設定され（対数スケールで100点）、その中から最小の交差検証誤差を与えるλが選択される。本研究では、LassoCVによって算出された特徴量重要度の中央値を閾値とし、それ以上の重要度を持つ特徴量のみを選択した。

本研究では、マインドワンダリング予測における各生理指標の寄与を検討するため、使用する特徴量セットを変えた複数のモデルを構築し比較した。具体的には、以下の4条件を設定した：

1. **RTCV Only**：行動指標のみ（反応時間変動係数、1特徴量）
2. **EEG Only**：脳波指標のみ（delta, theta, alpha, beta, gamma、5特徴量）
3. **Pupil Only**：瞳孔・視線指標のみ（瞳孔径統計量およびサッカード頻度、11特徴量）
4. **All Features**：上記すべてを統合（17特徴量）

評価指標には、予測スコアと実際のMWスコアのピアソン相関係数、および予測スコアを閾値0.65で二値化した分類器のAUC（曲線下面積）を用いた。検証は被験者の重複を避けるため、Leave-One-Subject-Out Cross Validation（LOSO）を採用し、各被験者をテスト群として用いた際の汎化性能を評価した。







